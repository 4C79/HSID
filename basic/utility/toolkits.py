import os
import matplotlib.pyplot as plt
import cv2
import numpy as np
from scipy.io import loadmat,savemat
from util import crop_center,crop_custom, Visualize3D, minmax_normalize, rand_crop,BandMinMaxQuantileStateful
import os
import numpy as np
import h5py
from os.path import join, exists
from scipy.io import loadmat, savemat

from util import crop_center,crop_custom, Visualize3D, minmax_normalize, rand_crop,BandMinMaxQuantileStateful
from indexes import cal_bwpsnr
from PIL import Image
import torch
import spectral
from skimage import io
import cv2 

def get_2048_from_1024_batch():

    name_list = set()
    data_path = '/data1/jiahua/result/supplyment_data/kaist/1024/'
    new_path = '/data1/jiahua/result/supplyment_data/kaist/2048/'
    rect_list = os.listdir(data_path)

    for rect in rect_list:
        name_list.add(rect[:-6])
    print(name_list)

    for rect in name_list:
        result_gt = np.zeros([2048,2048,3], dtype=np.float64)
        for i in range(4):
            if i == 0:
                img = cv2.imread(os.path.join(data_path,rect+'NW.png'))
                result_gt[0:1024,0:1024,:] = img[:,:,:]
            elif i == 1:
                img = cv2.imread(os.path.join(data_path,rect+'NE.png'))
                result_gt[0:1024,1024:2048,:] = img[:,:,:]
            elif i == 2:
                img = cv2.imread(os.path.join(data_path,rect+'SW.png'))
                result_gt[1024:2048,0:1024,:] = img[:,:,:]
            elif i == 3:
                img = cv2.imread(os.path.join(data_path,rect+'SE.png'))
                result_gt[1024:2048,1024:2048,:] = img[:,:,:]

        result_gt = minmax_normalize(result_gt)
        result_gt = result_gt*255
        cv2.imwrite(os.path.join(new_path,rect[:-12]+'.png'),result_gt)

def get_rgb():

    band = 29

    # img = loadmat('/data1/jiahua/result/urban/s2s.mat')
    # print(img.keys())
    # img = img['data'][...]
    # print(img.shape)
    # img = img.transpose((2,1,0))
    # img = img.transpose((1,0,2))
    # savemat('/data1/jiahua/result/urban/s2s.mat',{'data':img})

    
    # img = loadmat('/data1/jiahua/result/wdc/wdc_NGMeet.mat')
    # print(img.keys())
    # data = img['data'][...]
    # # img = img[32:,32:,:]
    # print(data.shape)
    # # data = data.transpose((2,1,0))
    # # data = data.transpose((1,0,2))
    # # data =  np.rot90(data)
    # # data =  np.rot90(data)
    # spectral.save_rgb('/home/jiahua/HSI-CVPR/hsi_pipeline/figure/wdc/wdc_NGMeet.png',data,bands=(76, 43, 10))
    
    # img = loadmat('/data1/jiahua/ly/test_data/real_dataset/test/test_s/40_3-34.mat')
    # print(img.keys())
    # gt = img['gt'][...]
    # noise = img['input'][...]
    # gt = np.rot90(gt)
    # noise = np.rot90(noise)
    # result_gt = np.zeros([512,512,1], dtype=np.float64)
    # result_gt[:,:,0] = gt[:,:,band]
    # result_gt = result_gt * 255
    # result_noise = np.zeros([512,512,1], dtype=np.float64)
    # result_noise[:,:,0] = noise[:,:,band]
    # result_noise = result_noise * 255
    # cv2.imwrite("/home/jiahua/HSI-CVPR/hsi_pipeline/figure/real_40/gt.png",result_gt)
    # cv2.imwrite("/home/jiahua/HSI-CVPR/hsi_pipeline/figure/real_40/noise.png",result_noise)

    # spectral.save_rgb("/home/jiahua/HSI-CVPR/hsi_pipeline/figure/real_40/gt.png",gt,bands=(9,19,29))
    ###############################################################################

    datasets = 'wdc'

    save_path = "/home/jiahua/HSI-CVPR/hsi_pipeline/figure/" + datasets + '_test'
    test_path = '/data1/jiahua/result/' + datasets
     
    rect_list = os.listdir(test_path)

    for rect in rect_list:

        img = loadmat(os.path.join(test_path,rect))  
        print(rect)
        if datasets == 'urban/':
            if rect == 'urban_LLRGTV.mat':
                # print(img.keys())
                data = img['output_image'][...]
            else:
                # print(img.keys())
                data = img['data'][...]
            if 'gru' in rect or 's2s' in rect:
                data = data.transpose((2,1,0))
            if 's2s' in rect:
                data = data.transpose((1,0,2))
            spectral.save_rgb(save_path + rect[:-4] +".png",data,bands=(102,138, 202))
        if datasets == 'real_40/':
            data = img['data'][...]
            if 'real' not in rect:
                data = data.transpose((2,1,0))
                data = data.transpose((1,0,2))
            data = np.rot90(data)
            # print(data.shape)
            # spectral.save_rgb(save_path + rect[:-4] +".png",data,bands=(5,11,16))
            result_gt = np.zeros([512,512,1], dtype=np.float64)
            result_gt[:,:,0] = data[:,:,band]
            if 'real_40_NGMeet.mat' == rect or 'real_40_LLRT.mat' == rect:
                result_gt =result_gt
            else:
                result_gt = result_gt * 255
            cv2.imwrite(save_path + rect[:-4] +".png",result_gt)
        if datasets == 'wdc':
            data = img['data'][...]
        
        result_gt = np.zeros([256,256,3], dtype=np.float64)
        result_gt[:,:,0] = data[:,:,9]
        result_gt[:,:,1] = data[:,:,19]
        result_gt[:,:,2] = data[:,:,29]
        result_gt = minmax_normalize(result_gt)
        result_gt = result_gt * 255
        cv2.imwrite(save_path + rect[:-4] +".png",result_gt)

def get_res():
    save_path = "/home/jiahua/HSI-CVPR/hsi_pipeline/figure/wdc_res/"
    test_path = '/data1/jiahua/result/wdc/'

    noise = loadmat('/data1/jiahua/result/wdc/noisy')
    gt = loadmat('/data1/jiahua/result/wdc/gt') 
    noise = noise['data'][...]
    gt = gt['data'][...]
    print(gt.shape)

    result = np.zeros([256,256,3], dtype=np.float64)
    rect_list = os.listdir(test_path)

    for rect in rect_list:

        img = loadmat(os.path.join(test_path,rect))

        data = img['data'][...]
        result[:,:,0] = -(data[:,:,76] - gt[:,:,76])
        result[:,:,1] = -(data[:,:,43] - gt[:,:,43])
        result[:,:,2] = -(data[:,:,10] - gt[:,:,10])

        # result = np.abs(result)
        # result = minmax_normalize(result)
        # result = result * 255
        import seaborn as sns
        plt.figure(figsize=(6, 6))
        sns.heatmap(result[:,:,1], annot=False, fmt='f', cmap='viridis',cbar=False,xticklabels=False, yticklabels=False)    
        plt.gca().set_aspect('equal', adjustable='box')
        fig = plt.gcf() 
        # fig.colorbar = False
        fig.savefig(save_path+rect[:-4]+".png",bbox_inches='tight', pad_inches=0,dpi=300)
        # fig.close()
        # cv2.imwrite(save_path+rect[:-4]+".png", result)
        print(rect)

def drawRect(dataname,area):

    test_path= "/home/jiahua/liuy/hsi_pipeline/draw_pic/" + str(dataname) + "/"

    save_path= '/home/jiahua/liuy/hsi_pipeline/draw_pic/' + str(dataname) + "_big/"
     
    rect_list = os.listdir(test_path)

    for rect in rect_list:
        
        i=j=lengh=lengw=0
        rate = 0
        
        if dataname == "kaist":
            lengh= 256
            lengw = 256
            i = 315 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 1788 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 8

        elif dataname == "cave":
            lengh= 64
            lengw = 64
            i = 265 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 374 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 8
            
        elif dataname == "icvl" or dataname == "icvl_img": # 276,53
            lengh= 64
            lengw = 64
            i = 73 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 95 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 8
        
        elif dataname == "real_15":
            lengh= 64
            lengw = 64
            i = 118 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 323 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 4

        elif dataname == "real_40":
            lengh= 64
            lengw = 64
            i = 122 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 321 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 8
        
        elif dataname == "india":
            lengh= 32
            lengw = 32
            i = 2 #要放大区域的左上角的 x 坐标（竖轴坐标）
            j = 24 #要放大区域的左上角的 y 坐标（横轴坐标）
            rate = 2

        elif dataname == "urban":
            lengh= 28
            lengw = 28
            i = 93 #要放大区域的左上角的 x 坐标（竖轴坐标）90 97
            j = 71 #要放大区域的左上角的 y 坐标（横轴坐标）66 73
            rate = 8

        elif dataname == "wdc" or dataname == "wdc_res":
            lengh= 32
            lengw = 32
            i = 160 #要放大区域的左上角的 x 坐标（竖轴坐标）97
            j = 77 #要放大区域的左上角的 y 坐标（横轴坐标）73
            rate = 8

        # rate = rate * 2
        img = cv2.imread(os.path.join(test_path,rect), -1)  #在cv2.imread参数中加入-1，表示不改变读取图像的类型直接读取
        print(img.shape)

        if len(img.shape) == 2:
            H,W = img.shape
        else:
            H,W,C = img.shape

        # # 复制灰度图像以便不影响原始图像
        # img = cv2.cvtColor(img, cv2.COLOR_GRAY2BGR)
        
        shift =1
        h = i+lengh  #要放大区域的高
        w = j+lengw  #要放大区域的宽
        h_2 = rate*lengh
        w_2 = rate*lengw

        pt1_1 = (j, i)  # 长方形框左上角坐标
        pt2_1 = (w, h)  # 长方形框右下角坐标 

        patch = img[ i:h,j:w]  # numpy 里先x，后y，x轴沿垂直方向向下，y轴沿水平方向向右
        # plt.imshow(patch)
        patch = cv2.resize(patch, (w_2, h_2))  #(w, h)
        
        pt1 = (0,0)
        pt2 = (h_2,w_2)

        if area == 1:     # 左上
            img[0:h_2,0:w_2] = patch
        elif area == 2:    # 右上
            img[0:h_2,0:w_2] = patch
        elif area == 3:    # 左下
            img[H-h_2:H,0:w_2] = patch
            pt1 = (0,H-h_2)
            pt2 = (w_2,H)
        elif area == 4:    # 右下
            img[H-h_2:H,W-w_2:W] = patch
            pt1 = (w_2,h_2)
            pt2 = (W,H)

        # # 256 3 , 512 6 , 1024 , 24
        # lineWidth = 6 # int (lengh/32/rate *12)
        # cv2.rectangle(img, pt1_1, pt2_1, (0,0,255), lineWidth)  # cv2 里也是先x，后y，x轴沿水平方向向右，y轴沿垂直方向向下
        # cv2.rectangle(img, pt1, pt2, (0,0,255), lineWidth)  # cv2 里也是先x，后y，x轴沿水平方向向右，y轴沿垂直方向向下

        # 定义红色（BGR 格式）的颜色
        red_color = (0, 0, 255)

        save_path_custom = save_path + rect
        img = cv2.resize(img,(256,256))
        cv2.imwrite(save_path_custom, img)

def tmp():
    grn_net = [23.100476333761137, 19.33382861258855, 12.691668294821508, 26.224827886355968, 16.550805687114682, 20.71980617200233, 28.35637726686629, 18.257944676076512, 9.07586822873391, 22.69388676286028, 13.714481868264375, 23.944624023478394, 25.21263525287195, 20.75500634841095, 17.802614896598815, 18.149968636525657, 18.70198972511475, 19.756662787562277, 14.05571007054927, 26.694990469330982, 25.492692291757763, 17.07065993330951, 27.2199653789011, 12.103405266908103, 18.508615867004472, 22.222807455532358, 20.844060582851803, 18.59509537539358, 21.25038230324617, 25.111376473372957, 18.150077216960053, 31.652977333326653, 28.142367180928066, 26.934275235908437, 31.28874137067742, 20.619841051793124, 17.690118804723834, 15.93808257136131, 24.914337169785686, 13.01276098312855, 20.0028723568951, 22.38203973411, 20.123213378604405, 25.373894465574317, 17.676701206060375, 20.938823260549405, 11.59755984965662, 20.222927105769056, 21.100767788561672, 19.949247209458782, 19.993591097723822, 17.4758446930106, 15.524208087154975, 21.92721977752958, 18.10183048900896, 25.365301786064474, 18.348110546007838, 17.92226566100041, 15.774359377394724]
    qrnn3d = [22.50842049157435, 18.917368488904444, 12.37314285136504, 25.66508449724865, 16.099496073850794, 20.04967263775018, 27.804004110638722, 17.98781072625834, 8.840553113829444, 22.155731227967948, 13.491582361871732, 23.351559681653264, 24.631052620784722, 20.22676047082839, 17.499925047231347, 17.743818412468503, 18.3343091088389, 19.541295864288205, 13.77636044322896, 26.017719108217854, 25.41379041672168, 16.890399516079675, 26.665998813706118, 21.98490513903736, 18.206490904049055, 22.043557408800552, 20.589377904627085, 18.45422661965228, 21.177894792311164, 24.775248852494045, 17.92788574234693, 31.51496112852528, 27.744884473325193, 26.580575520678067, 33.28682872591708, 20.448526457259025, 17.341389927760474, 15.653202903621128, 24.90190815975678, 12.808814001830068, 19.86717307260416, 22.078391244918855, 20.03789962526846, 25.597393372266154, 17.30515850922199, 20.670917041835988, 11.433252274560243, 20.349296174336676, 22.60526247631468, 20.01633771725497, 20.224218147420434, 17.521185403783367, 15.546901432439345, 21.9203110248775, 18.2126730996928, 25.102963690622012, 17.791017881625542, 17.592016601911368, 15.441275232568795]
    mac_net = [22.357418422391667, 19.04368048980561, 12.483104030662613, 25.32020544228007, 16.196945116325878, 20.09025621531959, 27.43315615553943, 17.981382144424735, 8.908875598854857, 22.13953612577707, 13.494088112041275, 23.420577860296866, 25.394448475509073, 20.352839696474554, 17.388643437593576, 17.792447297599914, 18.351126695765963, 19.496898284084935, 13.824419026769046, 26.31531469836635, 25.353420240805903, 16.84976454433821, 26.684570413096438, 22.07288784104889, 18.406619636060924, 21.669725853410693, 20.262507755303975, 18.178498642869656, 20.626706151052304, 24.445113713484368, 17.811730341841205, 31.292915317038926, 27.46303831676482, 26.430051710766225, 34.18732940439748, 20.384450742783216, 17.27862934970311, 15.70844695953979, 24.100649978186038, 12.993355455797769, 19.995482995622716, 21.939836190346956, 20.078311327364364, 25.341172717167595, 17.419214593727077, 20.730089199289058, 11.459507165960478, 20.864368236065225, 23.434937433916318, 19.873068679290704, 20.709491211773283, 17.678945430908463, 15.701251183872584, 21.906550161633007, 18.164074445176, 25.146006102771963, 17.656848427850793, 17.75812393010736, 15.265638473651638]
    sst = [22.653966751075274, 19.125813829505297, 12.428278177877678, 26.072422770810203, 16.14441081148122, 20.24370425294491, 28.303411120495618, 18.13128394145382, 8.932668352916025, 22.370074952279175, 13.536960358414628, 23.509169966263272, 24.611506293872505, 20.43145204313293, 17.615430453334362, 17.899137205137237, 18.542986861249968, 19.67030947646754, 13.884403297882038, 26.502276351123964, 25.75473761393956, 17.005575957852557, 26.967712430915956, 22.30044952165141, 18.340437035418297, 22.2077995258961, 20.765727307960972, 18.533927829022154, 21.48578903897443, 25.080639169377285, 18.198439329721047, 31.89518878665495, 28.565864985037813, 26.88507938879314, 32.953762651610845, 20.683505460100207, 17.449614258512874, 15.808736014003266, 25.43585938496532, 12.861820013363493, 19.939223544384713, 22.186658223264942, 20.17592116471643, 26.18091862863936, 17.491773530516998, 20.78693002468862, 11.502068312780485, 20.43944083692989, 22.456674585365132, 20.11641655022611, 20.262611674187806, 17.891359376619832, 15.833058338847644, 22.088069888951004, 18.26437580852419, 25.610779278054, 17.93928616849131, 17.712690744834504, 15.578350191873945]
    man = [23.263911291433757, 19.845705225481332, 13.33855520820892, 26.065228507249195, 16.983861407485627, 20.93025781570425, 27.886759599810713, 18.721099731675288, 9.624599924397254, 22.846332700750914, 14.266921964157023, 24.097704039253152, 24.688840073389894, 21.067139479882933, 18.382713109058816, 18.64432348076337, 19.200794643136188, 20.358349334334306, 14.513699243824217, 26.063586624774228, 25.99889348606302, 17.54263810255339, 27.353960540389068, 22.51533525790627, 19.103699955078408, 22.890427322508778, 21.42698774429106, 19.381354943650226, 21.631367777000104, 25.379617851559264, 18.70970194305162, 31.66918397853511, 27.962555652731755, 27.269683889027426, 33.079907882548866, 21.086361983081108, 18.2284118314598, 16.63134067286939, 25.238785107143784, 13.500403643479927, 20.427214897568657, 22.86541209679609, 20.658631465130394, 25.656090574918135, 18.30209735117257, 21.342462874587536, 11.9116792416419, 20.867514859954127, 23.020037127788324, 20.536186214698674, 20.777470780335925, 18.132008215221767, 16.16802755471355, 22.350139271908013, 18.61417027355176, 25.51187581154251, 18.687484188276375, 18.396658893915035, 16.39205827358341]
    gru_net = [23.42835615530592, 19.670397019683136, 13.011718756539675, 26.32740763843532, 16.722404867594268, 20.585074194276377, 28.448129662788848, 18.683244580614023, 9.5449648451368, 22.746315421857986, 14.16327672883789, 24.021821378289886, 25.470738691452915, 20.729961578918726, 18.08095990361351, 18.266334793612277, 18.890924119039273, 20.136489760170964, 14.269788545899095, 26.45097339118961, 26.290300019286168, 17.47402798683136, 27.4247432427473, 22.758242306616896, 18.632957749318507, 22.59953841304952, 21.057647465142228, 18.976242103203944, 22.126583553117523, 25.735069085187682, 18.83867027623117, 32.15770401169353, 28.49867097020762, 27.35883854612599, 33.910626536615446, 21.350446784046156, 17.976819735460392, 16.26630147234756, 25.81604039723133, 13.326922446043673, 20.295056039911437, 22.623374216851737, 20.602779653297027, 26.158459843649485, 18.032066703690276, 21.01235306806825, 11.899463734768002, 20.79508496804456, 22.92304649618619, 20.209258792598742, 20.530962978370745, 18.06429175991924, 16.064580980465472, 22.404826293012857, 18.614267435136895, 25.524364517510435, 18.386117069908625, 18.335380515933736, 16.18955053036627]
    scat = [23.61482967477233, 19.901241626600342, 13.136677759217713, 26.778352846132485, 16.802340616705443, 20.93495904192909, 29.04882400749255, 18.645716578424405, 9.541685547736032, 23.111468737281246, 14.211216811160606, 24.217468696962307, 25.62144079394966, 21.070694092366598, 18.234477670670692, 18.578667253409705, 19.15199816658676, 20.305734519194907, 14.413816810774259, 27.281516341423153, 26.56514386501212, 17.509607410946135, 27.552692459963556, 23.24279950104431, 18.890177287187363, 22.777275242696142, 21.28047507588847, 19.089768149395717, 22.40706255830797, 25.854011078701788, 18.874876888562216, 32.33427314409811, 28.679916139874212, 27.592762875196847, 33.49390101789591, 21.47020108997759, 18.02620003568905, 16.364578624821064, 25.82099166576739, 13.445794133909704, 20.39253551299034, 22.767236897342627, 20.62807165055947, 26.301452062453357, 18.095664529921493, 21.249817002736933,11.896970657338837, 20.983278231857817, 23.089548695070516, 20.58289402705843, 20.69226794456783, 18.12466910363118, 16.13742882555066, 22.365945140451345, 18.783910748331376, 25.950602186880047, 18.73976144794253, 18.67084816870954, 16.4336461201518]
    sert = [22.531827792543325, 19.086132900108808, 12.427612721778909, 25.841416683515817, 16.14098401285662, 20.180974821963247, 28.0735236398772, 18.056926283451844, 8.874349293153461, 22.236844167517003, 13.517883692656314, 23.380836788570008, 24.68943523697188, 20.38054753111038, 17.564962681277574, 17.89138108958845, 18.456734969803946, 19.61352473726877, 13.879801442206745, 26.314861155056022, 25.581254997569093, 16.942181121801433, 26.72529445599985, 22.18048958697995, 18.229452766901154, 22.056419077131356, 20.609008923470284, 18.44407729539209, 21.381000052544813, 24.868826657080014, 18.010636686452585, 31.561832950116383, 27.928044101547677, 26.660190591044334, 33.17575945175845, 20.603088895603747, 17.34977440741941, 15.678463063131082, 24.966632392132894, 12.878562344776288, 19.86274541175606, 22.078950952222073, 20.05419108973703, 25.693620630058447, 17.261928652224867, 20.651050474642155, 11.46566081195828, 20.3442636098448, 22.49416538502397, 20.10344576391423, 20.27621417250583, 17.57084626394462, 15.541547769684335, 21.926094415930685, 18.21049258670439, 25.18060957479331, 17.881290917213278, 17.693998513298673, 15.536336517982448]
    s2s = [23.26818141690047, 19.652083796987238, 13.041202430388031, 26.35387324986336, 16.757992914967378, 20.757032129069934, 28.633466030296105, 18.662599897238714, 9.531181193144779, 22.954414438105434, 14.148612139920447, 23.934755265089827, 25.546641796039648, 20.961781676554637, 18.172776735831583, 18.45133034230353, 19.044785022310503, 20.269038369469257, 14.397199712744698, 26.9795418832195, 26.43481197902754, 17.498706166932795, 27.227012536261082, 22.92424490874611, 18.862082660015712, 22.778484324584745, 21.28807094541041, 19.09056645073597, 22.205829562757117, 25.60534615608968, 19.002149263376236, 32.15117085154324, 28.665437316154687, 27.26605533034052, 34.51374194808774, 21.419725907075275, 17.957756654224614, 16.27277871526641, 25.719316722142175, 13.40451901140648, 20.347579622469187, 22.647910945671253, 20.61051168030394, 26.187336482049748, 17.940498505112622, 21.057523859268894, 11.880928131420362, 20.85130426035355, 23.063793242280756, 20.585962986638826, 20.794198094323278, 18.130492108055265, 16.046056641425732, 22.424137107007827, 18.653025478845194, 25.60564234702467, 18.51869212576273, 18.53927802296141, 16.374304202283493]
    loc = [1,10,11,12,13,14,15,16,17,18,19,2,20,21,22,23,24,25,26,27,28,29,3,30,31,32,33,34,35,36,37,38,39,4,40,41,42,43,44,45,46,47,48,49,5,50,51,52,53,54,55,56,57,58,59,6,7,8,9]
    top_15 = [34, 31, 32, 6, 33, 22, 19, 20, 3, 43, 38, 55, 29, 12, 11]
    ### get real image ###
    # loc1 = [i for i in loc]
    # loc2 = [(loc1[i],s2s[i]) for i,j in enumerate(loc)]
    # # 使用enumerate函数将值和其索引一一对应
    # 使用sorted函数按值的大小降序排列列表
    # [40, 38, 39, 15, 4, 3, 27, 28, 12, 49, 44, 6, 36, 20, 2]
    # indexed_list = loc2

    # indexed_list = list(enumerate(s2s))
    # # # [34, 31, 32, 6, 33, 22, 19, 20, 3, 43, 38, 55, 29, 12, 11]
    # sorted_list = sorted(indexed_list, key=lambda x: x[1], reverse=True)
    # print(indexed_list)

    # sorted_list = sorted(indexed_list, key=lambda x: x[1], reverse=True)

    # # 获取前15大值的位置
    # top_positions = [index for index, value in sorted_list[:15]]

    # print(top_positions)

    topk_psnr = 0

    for i in top_15:
        topk_psnr += man[i]
    
    print(topk_psnr/15)

def get_real_top_k():
    k = 15
    s2s = [23.2239030822718, 21.604374807206714, 19.736699461888385, 18.189079962488755, 13.007604067318942, 11.82206625085448, 26.484558384861913, 24.72719285658275, 16.67435641205357, 15.61381717192565, 20.7074589058874, 19.559667856662966, 28.59773212277056, 26.974653824258347, 18.584337574212956, 17.36673696556337, 9.593865272822672, 8.10489429556828, 23.00702372793653, 21.412364834013967, 14.021435503956862, 12.955539728056515, 23.9778067447435, 22.58768450937519, 24.99490800066839, 24.59511000202518, 20.782012607627735, 19.965007658878108, 18.04279095763659, 17.070279765691684, 18.368059735590652, 17.363611028871947, 18.948623563908107, 17.906926857345915, 20.18269390600758, 19.0749990743875, 14.225418973468836, 13.59802548875791, 26.65937403240228, 26.050003023511962, 26.198847762134626, 24.822017159257356, 17.35028304585664, 16.421302914501464, 27.2778206934503, 25.838024837095144, 22.991013410177747, 21.078704840527074, 18.955892759927433, 17.59707441348767, 22.86677908145225, 21.331993190694405, 21.415264952815804, 19.92074137491994, 19.290363874916206, 17.62390556158162, 22.338590363849057, 20.225843302553592, 25.837680468248085, 23.66427715124526, 19.258501138957556, 17.086774195789573, 32.133480691605506, 31.16204307506829, 28.687708007143787, 27.610686997241483, 27.277487085637993, 25.732046259466184, 34.881380001833406, 33.59360668159103, 21.693341943209713, 19.549882385301686, 18.104040807986063, 16.57232920959067, 16.395184243289705, 14.90597145387205, 25.998654741241346, 24.159082899456262, 13.14752470146288, 12.669146382489693, 20.29280763984672, 19.495287154123737, 22.543001371891116, 21.593360082547818, 20.70473498238166, 19.392723510088814, 26.406654589317856, 24.98287718524835, 18.109338255323966, 16.322443862575614, 20.96796738232031, 20.36550875374759, 11.980331954290316, 10.844345160417848, 20.763062868634787, 19.880778060381235, 22.909725235597545, 22.235434458565926, 20.5804894565225, 19.91919083258354, 20.76072183000724, 20.033612304456586, 17.948251047476916, 17.220684994487286, 15.920964324434673, 15.119350474638386, 22.225809560123036, 21.661981086100962, 18.438459900482837, 18.02980977774292, 25.68712432051195, 24.31291747119679, 18.63363186159065, 16.96196732906172, 18.63226245682062, 16.70912598596097, 16.412778978693545, 14.69159602346002]
    sert = [23.398124842110082, 21.665530742976564, 19.974023280854016, 18.198242519363596, 13.063190406577672, 11.792035036980145, 26.803190032908685, 24.879643334122953, 16.72068055794376, 15.561287467769478, 20.83966309817774, 19.522286545748756, 28.954647269544868, 27.192400010209536, 18.696950940163102, 17.416901626740582, 9.64603244513231, 8.10266614117461, 23.03410508325588, 21.439583251778124, 14.076861501306563, 12.958905884006064, 24.132794638688893, 22.62887893845112, 24.789577539607322, 24.58929293433644, 20.878784108978255, 19.882310953242506, 18.090538696489528, 17.03938666606562, 18.47266443350952, 17.310097745667377, 19.028024514828733, 17.885445424779157, 20.194683615464495, 19.032365859073042, 14.262152244452151, 13.497450639961338, 26.815868309800475, 25.813854000311572, 26.32601307461661, 24.836496920521576, 17.429663041120712, 16.45469920248215, 27.515328999111105, 25.935259912888593, 23.228912605039135, 21.132066568920763, 18.94156119853736, 17.51734433526495, 22.810806572974858, 21.302031581287853, 21.359963187149827, 19.85805465979074, 19.276847801212615, 17.61130678957157, 22.49366234726544, 20.268337757824185, 25.950046737848243, 23.787606576311784, 18.994920786756076, 17.0263525861491, 32.12162071784831, 31.002045182384453, 28.5189301764912, 27.337158026604154, 27.48051947183342, 25.839861710255242, 33.50038869191901, 32.851130211597905, 21.632948741115506, 19.57322905009199, 18.11998102122903, 16.579567793609794, 16.454844532636773, 14.90208159362539, 26.083036419333006, 23.850228364932782, 13.17855681139025, 12.578567878162325, 20.284161980503974, 19.44132884300814, 22.563789168203638, 21.594112736240508, 20.716647618866713, 19.39173456060735, 26.410489083281735, 24.976752176835163, 18.210519871533, 16.313337432916736, 21.035526402865948, 20.266574546418365, 12.045542375048267, 10.88577924886829, 20.837870408794977, 19.85065681089462, 22.90368907149043, 22.084641698557512, 20.521733296024696, 19.68515823180376, 20.74124831500053, 19.811180030011133, 17.968047231820503, 17.173645296068738, 15.974157012546188, 15.108938526822481, 22.189593647169403, 21.66259518469197, 18.50251331500121, 17.918471858407575, 25.95557108245608, 24.40564806713054, 18.766354909653803, 16.99622692477275, 18.66862231586537, 16.719374710731977, 16.392562864246436, 14.68011017171846]
    sst = [23.633378601603106, 21.674554900547438, 20.059480258287774, 18.192147400722817, 13.095197526471882, 11.761358829283473, 27.07951031784974, 25.065335223770667, 16.770022181087455, 15.518799441874984, 20.991373503768276, 19.496035002121538, 29.182276558022295, 27.424545682968937, 18.716818962111983, 17.545748920795656, 9.729525041628374, 8.135811664203676, 23.282724574762675, 21.457425329795676, 14.101347487404775, 12.972573229424482, 24.251869812729645, 22.766470119796903, 24.73773169483527, 24.485280892909742, 20.918048536836416, 19.944855549429438, 18.120363524896025, 17.110497381772703, 18.533046584126936, 17.265227826147534, 19.143356454303294, 17.942617268196642, 20.215938486428676, 19.124680466506405, 14.220967934424985, 13.54783866133909, 26.84088822233884, 26.163664479909087, 26.412820318673614, 25.09665490920551, 17.46133380269623, 16.54981811300888, 27.7766903134972, 26.158734548334714, 23.346489742800237, 21.254409300502576, 19.137348425327772, 17.54352564550882, 23.060995097217603, 21.3546039545746, 21.64113563851204, 19.8903189774099, 19.455614990413288, 17.612240667631024, 22.684225715859302, 20.287352362089557, 26.322173043229814, 23.83910529552476, 19.206127074805263, 17.190751584636832, 32.52387176925088, 31.26650580405902, 29.231280676510845, 27.90044929356478, 27.830489517934005, 25.939669259652277, 33.68830310824916, 32.219222194972524, 21.740818056415947, 19.626192863784464, 18.27329498380287, 16.625933533222877, 16.638170099223938, 14.979301928782593, 26.614332630029597, 24.257386139901037, 13.114695443122331, 12.608944583604655, 20.334251435885438, 19.54419565288399, 22.69005347579037, 21.68326297073951, 20.878487397019835, 19.473354932413027, 26.85507057513641, 25.50676668214231, 18.548494565398162, 16.435052495635833, 21.18619007925248, 20.387669970124758, 12.061322836187157, 10.942813789373814, 20.97720249113214, 19.90167918272764, 22.937146755442573, 21.97620241528769, 20.527618934445186, 19.705214166007032, 20.61715996337908, 19.90806338499653, 18.41398211438251, 17.368736638857154, 16.356751740684707, 15.309364937010582, 22.383585226202687, 21.79255455169932, 18.5437161143807, 17.985035502667678, 26.80298967359751, 24.418568882510492, 18.867230292988665, 17.011342043993956, 18.70330393959728, 16.72207755007173, 16.457017368457493, 14.699683015290395]
    man = [23.263911291433757, 19.845705225481332, 13.33855520820892, 26.065228507249195, 16.983861407485627, 20.93025781570425, 27.886759599810713, 18.721099731675288, 9.624599924397254, 22.846332700750914, 14.266921964157023, 24.097704039253152, 24.688840073389894, 21.067139479882933, 18.382713109058816, 18.64432348076337, 19.200794643136188, 20.358349334334306, 14.513699243824217, 26.063586624774228, 25.99889348606302, 17.54263810255339, 27.353960540389068, 22.51533525790627, 19.103699955078408, 22.890427322508778, 21.42698774429106, 19.381354943650226, 21.631367777000104, 25.379617851559264, 18.70970194305162, 31.66918397853511, 27.962555652731755, 27.269683889027426, 33.079907882548866, 21.086361983081108, 18.2284118314598, 16.63134067286939, 25.238785107143784, 13.500403643479927, 20.427214897568657, 22.86541209679609, 20.658631465130394, 25.656090574918135, 18.30209735117257, 21.342462874587536, 11.9116792416419, 20.867514859954127, 23.020037127788324, 20.536186214698674, 20.777470780335925, 18.132008215221767, 16.16802755471355, 22.350139271908013, 18.61417027355176, 25.51187581154251, 18.687484188276375, 18.396658893915035, 16.39205827358341]
    macnet = [23.06667855008394, 21.6481582946994, 19.81906760004741, 18.268293379563804, 13.108696792341151, 11.857511268984076, 26.022886074359217, 24.617524810200926, 16.74620282204739, 15.647687410604366, 20.737104471414465, 19.44340795922472, 28.101649615188958, 26.764662695889896, 18.578707070692257, 17.384057218157213, 9.668498597439767, 8.149252600269948, 22.906521649551127, 21.372550602003017, 14.018026938148319, 12.97014928593423, 24.185485591723147, 22.65567012887059,25.5105143973101, 25.27838255370804, 20.80010519316521, 19.905574199783903, 17.837420294271315, 16.939866580915837, 18.342249786361563, 17.242644808838268, 18.860791749799542, 17.841461641732387, 19.91991731202494, 19.073879256144934, 14.170927309497397, 13.477910744040694, 26.73918735970475, 25.891442037027947,25.979022053882314, 24.72781842772949, 17.29886007787546, 16.40066901080096, 27.392896416909338, 25.976244409283535, 22.9271001207436, 21.218675561354175, 19.0491043724367, 17.764134899685146, 22.159485732145097, 21.17996597467629, 20.83497926352588, 19.69003624708207, 18.921604951582523, 17.43539233415679, 21.594167372239895, 19.65924492986471, 25.417241857015437, 23.472985569953302, 18.559797712283185, 17.06366297139923, 31.466868004041114, 31.11896263003674, 27.581363588003235, 27.344713045526404, 27.114946172862787, 25.745157248669663, 34.67609186983556, 33.6985669389594, 21.291620758347104, 19.477280727219327, 17.97525395972798, 16.582004739678244, 16.4876776867729, 14.929216232306679, 25.0481621105808, 23.153137845791274, 13.280811900037419, 12.705899011558117, 20.391225230487393, 19.599740760758042, 22.332262101341822, 21.54741027935209, 20.69387906747651, 19.46274358725222, 26.04558685560762, 24.63675857872757, 18.358077517720158, 16.480351669734, 21.092893137275794, 20.36728526130232, 12.026262863714075, 10.892751468206878, 21.516238570007353, 20.2124979021231, 23.87541794997833, 22.994456917854304, 20.26265728527144, 19.483480073309966, 21.148055289552442, 20.270927133994128, 18.067842854676282, 17.290048007140648, 16.13973207162475, 15.262770296120419, 22.160059430847788, 21.653040892418222, 18.44902633605063, 17.879122554301368, 25.86863226501451, 24.423379940529415, 18.454292327996026, 16.85940452770556, 18.6339139265152, 16.882333933699524, 16.00249769193391, 14.528779255369363]
    qrnn3d = [23.400689456755526, 21.616151526393175, 19.80226333030219, 18.032473647506695, 13.016713307504366, 11.729572395225714, 26.598340608680576, 24.731828385816723, 16.69168687993928, 15.507305267762307, 20.732755651037333, 19.36658962446303, 28.60948846294053, 26.99851975833691, 18.62874236296911, 17.34687908954757, 9.60952234320744, 8.071583884451446, 22.990773168189655, 21.320689287746244, 14.048751066513884, 12.93441365722958, 24.1511119538089, 22.55200740949763, 24.954637050569065, 24.307468191000375, 20.71040035275149, 19.74312058890529, 18.032143121406182, 16.96770697305651, 18.31679304636471, 17.170843778572294, 18.901192925264503, 17.767425292413296, 20.127758058681547, 18.954833669894864, 14.152041172615718, 13.400679713842203, 26.461450700283635, 25.573987516152076, 26.087726621153102, 24.739854212290258, 17.379038273681807, 16.40176075847754, 27.490514188526795, 25.841483438885437, 22.99510196524215, 20.974708312832572, 18.986621453909844, 17.42636035418827, 22.85517884027134, 21.231935977329766, 21.419976125459304, 19.758779683794867, 19.366473083019493, 17.541980156285074, 22.28984175329811, 20.065947831324216, 25.888325114796412, 23.66217259019168, 18.94914561160382, 16.90662587309004, 32.09474079603928, 30.935181461011275, 28.370480082589562, 27.119288864060824, 27.446725009532283, 25.71442603182385, 33.848832698919914, 32.72482475291425, 21.476311940328895, 19.420740974189155, 18.139957956129518, 16.54282189939143, 16.45055763020627, 14.855848177035986, 25.990562330281946, 23.813253989231615, 13.097478467832484, 12.520149535827654, 20.288153648462956, 19.446192496745365, 22.588424278222917, 21.56835821161479, 20.713553457594912, 19.36224579294201, 26.381143532873264, 24.81364321165904, 18.26898500359607, 16.34133201484791, 21.011491842150708, 20.33034224152127, 12.0120335303929, 10.854471018727587, 20.86545484511357, 19.83313750355978, 23.029944461767162, 22.1805804908622, 20.374736453628593, 19.657938980881344, 20.63041659434815, 19.818019700492716, 17.934243991601832, 17.1081268159649, 15.996081313077696, 15.097721551800996, 22.177827478347584, 21.662794571407417, 18.46561768502974, 17.95972851435586, 26.01027463116579, 24.195652750078235, 18.711086733850713, 16.87094902940037, 18.564343547697938, 16.619689656124798, 16.279935936972485, 14.602614528165104]
    grn_net = [24.042446709498666, 22.158505958023603, 20.40808646500849, 18.25957076016861, 13.41657293364472, 11.966763655998294, 26.934858881471815, 25.514796891240124, 17.333537159946122, 15.768074214283239, 21.559164384779418, 19.88044795922524, 28.649659209449588, 28.063095324282987, 18.93095457446847, 17.584934777684552, 9.973321965256805, 8.178414492211015, 23.721995221411934, 21.66577830430863, 14.381501902156073, 13.04746183437268, 25.023152676702843,22.866095370253944, 25.34041519151159, 25.084855314232314, 21.317992973569975, 20.19201972325193, 18.4232880273315, 17.18194176586613, 18.76459464243163, 17.535342630619684, 19.39396695914546, 18.010012491084044, 20.394250466144467, 19.119075108980088, 14.501359170600487, 13.610060970498054, 27.140927336944358, 26.24905360171761, 26.03897620555324, 24.946408377962285, 17.569264348987396, 16.572055517631625, 28.13882947375769, 26.301101284044517, 2.4239106559165, 21.782899877899705, 19.356102593306947, 17.661129140701995, 23.266778512813467, 21.17883639825125, 21.911985397609183, 19.776135768094427, 19.644900680988094, 17.545290069799066, 22.3184443153469, 20.182320291145444, 26.211696760417347, 24.01105618632857, 19.313580555124357, 16.98657387879575, 31.95534634419129, 31.350608322462012, 28.65667367687995, 27.62806068497618, 27.906064253528665, 25.962486218288205, 31.579857258713723, 30.997625482641116, 21.80325291937969, 19.436429184206556, 18.684099426114457, 16.69613818333321, 16.921480376421083, 14.954684766301536, 25.71891096197881, 24.10976337759256, 13.379702312790515, 12.645819653466583, 20.490238285038167, 19.515506428752033, 23.145173965121437, 21.61890550309856, 20.753132644022056, 19.49329411318675, 25.969316684377098, 24.77847224677154, 18.97863102350078, 16.374771388619973, 21.355693476022616, 20.52195304507619, 12.220520605360209, 10.97459909395303, 20.75717437771802, 19.688679833820093, 21.496745366983788, 20.704790210139556, 20.252582768635655, 19.645911650281914, 20.369444340086876, 19.61773785536077, 17.832464912162692, 17.11922447385851, 15.954158165524966, 15.094258008784983, 22.1123227513599, 21.742116803699258, 18.405182685858325, 17.798478292159597, 26.306360188119996, 24.424243384008953, 19.596744120245127, 17.09947697177055, 19.06860630168513, 16.775925020315693, 16.818375799632683, 14.730342955156763]
    
    # sert_new = []
    # for i, j in enumerate(grn_net): 
    #     if i*2 >= len(grn_net):
    #         break
    #     sert_new.append((grn_net[2*i]+grn_net[2*i+1])/2)
    # print(sert_new)
    # print(len(sert_new))

    for i in range(len(s2s)):
        if s2s[i]>sert[i]:
            print(i," ",s2s[i]-sert[i])

def residual_noise(test_path):

    noise = Image.open(test_path + "/noise.png")
    gt = Image.open(test_path + "/gt.png")

    save_path= '/home/jiahua/HSI-CVPR/hsi_pipeline/figure/icvl_img_big_res/'

    result_gt = np.zeros([128,128,3], dtype=np.float64)
     
    rect_list = os.listdir(test_path)

    for rect in rect_list:

        # 打开两个图像文件

        image = Image.open(test_path+rect)

        # 确保两个图像具有相同的大小
        if noise.size != image.size:
            raise ValueError("两个图像的大小不一致")

        # 将图像转换为 NumPy 数组
        array1 = np.array(noise)
        array2 = np.array(image)
        array3 = np.array(gt)

        # 进行像素相减
        result_array = np.abs(array3 - array2)

        # 创建一个 PIL 图像对象
        result_image = Image.fromarray(result_array)

        # 保存结果图像为 PNG
        result_image.save(save_path+rect)

def result_resize():

    new_path = '/data1/jiahua/result/supplyment_data/icvl_result/'
    rect_list = os.listdir(new_path)

    for rect in rect_list:
       
        img = cv2.imread(os.path.join(new_path,rect))
        img = cv2.resize(img,(256,256))
        cv2.imwrite(os.path.join(new_path,rect),img)

def draw_bands_fig():
    # WDC
    import matplotlib.pyplot as plt

    plt.figure(figsize=(16, 4),dpi=400)

    Bands = np.arange(191)  # Band number
    # noisy 13.98
    noisy = [13.895706182312523, 11.351148079993544, 23.637681065181848, 13.447790222790054, 11.049010598998983, 13.910696405468357, 11.414835327901724, 18.14045692839706, 7.587528202938508, 13.826879209387767, 17.787564605655348, 14.014577270202002, 22.588166248360547, 17.583277466897176, 17.905560157791562, 6.199827400673163, 17.99799955220004, 6.442129686313038, 6.034082575112119, 14.138110616732655, 7.501698295050221, 6.507650862324724, 13.918299752626893, 13.927728617407746, 7.807550605753502, 14.006880665081642, 13.846612432917066, 6.444996604567695, 17.62972102405326, 7.378483952895976, 24.00092277214953, 13.930237121582685, 14.069902908342304, 11.243389104842848, 13.50171745096281, 6.408601825558508, 11.203060788206162, 6.9265130549839515, 8.19096184261473, 17.349808992167233, 18.215742921401944, 11.264742544103786, 11.148894606946918, 13.593074272555995, 5.877485458527909, 13.858518854651473, 17.27315126241174, 11.177043726815178, 20.317413992130792, 23.900158417324473, 13.950719584826363, 13.245632305796187, 5.678203592917398, 13.80147580965038, 20.314959750181636, 6.1699415382775955, 24.193204807731213, 13.576606585848639, 13.689562747751012, 11.23398898624739, 15.750685376767606, 13.876801506600604, 14.00883960469143, 6.436263906232934, 11.043071754912834, 9.704713686092944, 13.779757843088795, 10.029315155832137, 11.174474044321954, 13.86983352346643, 14.03200241629076, 11.187465954259553, 24.88829602195687, 26.396591291571344, 11.074207832778974, 12.942132549128454, 18.059139853747162, 22.05571914602843, 18.256177272242155, 14.55018181861076, 6.096021452684493, 24.727314483875556, 11.1534278501083, 11.023403337199687, 6.304783615240444, 7.9558633816153455, 19.13849796172463, 24.439885020715035, 5.262000231152202, 18.410174341093445, 18.01686894483525, 14.361658139620017, 14.011811707491479, 17.962461573019677, 18.239757668447155, 13.978366229336094, 14.101909132198841, 17.954340182226154, 26.02636497148518, 27.201068889127864, 13.872029560657364, 24.40590965999583, 24.359388911395836, 10.824341689571584, 24.592257888422523, 5.9342451195809165, 14.780722132870736, 18.138186692377403, 8.330560853013514, 27.292821967382498, 14.695498819974045, 7.996371763471782, 11.59432884888362, 11.852780886953855, 24.54042140285943, 11.713250888718516, 18.989284963165346, 8.693624682673164, 13.52664421132932, 14.574426119837698, 13.894730117230708, 11.829012213987983, 18.937803678127164, 27.680206629449962, 14.77989358866833, 11.11256123969068, 11.18723385764081, 18.25286720638053, 6.1854985374568585, 11.031041183030307, 28.33024743609446, 17.994620751756145, 6.934033626808494, 6.868134384028357, 4.522600761144514, 9.305082376531317, 12.840358439279402, 18.98134206924949, 14.462463214065266, 4.53585894081879, 18.19590916527568, 14.79960111881757, 13.009448526432852, 28.42028339681264, 5.47759530562553, 28.53602844160923, 11.097132553992486, 7.554162965773688, 18.871624472803184, 13.997279495530247, 14.765385593341042, 4.404698137386896, 24.95335483138397, 14.041423668883438, 14.418989223623157, 24.19612693444215, 4.640708265627504, 8.026021193409562, 5.926411460608465, 10.77045777277168, 11.210523542006827, 17.989342437372564, 24.272223276150267, 8.03601548613334, 13.023936675927743, 19.1720201380602, 28.43954729647691, 11.168679603992427, 23.921742343878236, 14.020363285669742, 4.605109201795676, 17.73574186934177, 4.617837993706147, 10.709173963315292, 5.403171228335069, 11.745552930212302, 11.05025697442299, 14.769849960787102, 28.668667436662147, 5.502045361381991, 5.3883096819385345, 11.626477902152587, 4.315627521438364, 28.865175387013387, 9.299029700921533, 5.897759576586445, 4.458789947976945, 5.436617309853791, 12.165328159206421, 17.853924351066894, 5.990747656778705]
    # qrnn3d 33.96
    qrnn3d = [34.69645856091499, 31.328146174349634, 37.41840643761732, 35.95545279481843, 36.36589647751443, 36.74723086196701, 35.40571367478166, 32.28546576978403, 26.921025211246487, 31.39241902909024, 33.49923215062999, 34.46683506518718, 34.95857523434991, 33.05797108867901, 33.36751755125745, 32.466335937060556, 33.172628942010036, 30.05986941798115, 29.677384065169726, 31.49738216391625, 31.5256366939148, 31.359758851117803, 30.960138578804628, 31.89620975950988, 31.191373367107484, 31.912256188135398, 31.9434354723328, 30.929535459751094, 31.41635844980113, 30.927687765243054, 32.45674198976869, 32.20668786548971, 32.03997030572725, 31.567031617471418, 31.42113713794817, 30.163774029978754, 30.672281283684946, 29.564453808381074, 30.07014700027703, 30.990632136749937, 31.046234967744184, 30.454580816743594, 29.40668085824692, 30.52808512545272, 29.585871564077944, 31.085669844338284, 31.001775966867598, 30.9016773506788, 31.447646504250212, 31.187343882986, 30.627617046776265, 30.31215968111317, 28.084551243865015, 30.903355573704623, 31.397158286177262, 28.62172098809054, 31.13384472057062, 27.907940168919396, 27.23814256343283, 25.85753009972747, 27.863654999060515, 27.21590529904789, 27.57430427373169, 27.615817294217955, 26.718188575193853, 27.751398984598616, 28.036505949554538, 27.934400170220112, 27.520868672494444, 26.81268638806322, 28.253017592573162, 26.193489797544956, 30.976244167944202, 30.66312328844964, 30.905354516636265, 33.06304668531113, 31.68263331039471, 31.510786890299705, 31.78110214245679, 31.994984630742692, 30.465563225489824, 32.33472320682922, 31.55902197916007, 28.070284221677273, 30.422077965299557, 28.58950792601991, 29.367474291398025, 34.629716049662974, 30.35656636230865, 30.690897696964058, 32.037430569005124, 31.59863186756063, 32.40071789371361, 32.41237459489314, 32.92067005766734, 33.66463544829911, 33.0404205994482, 32.54717716058313, 33.504894590449624, 36.23612850585161, 38.67299357859699, 33.656457481767, 35.67995261284559, 35.65340020399925, 37.59638352630197, 33.742807724679345, 38.01353360496333, 36.753524747003354, 34.63867072860684, 34.728611299010616, 32.38818320493546, 32.75433680499833, 32.213259949312814, 35.7106534576376, 36.26677275160012, 36.733169659823936, 36.16316307036206, 35.431310576714644, 36.327058430479234, 36.31864719939259, 36.03081404847854, 35.00577355206206, 35.66500971663339, 36.66748397540522, 36.56145904145123, 37.688186301853, 39.04243694588931, 38.35625912266972, 35.17752604172595, 38.56386013295167, 40.19344153281554, 39.37161737632868, 33.99084827045838, 33.37165607308327, 31.41525008781798, 36.1137491420478, 37.75519848032134, 40.55764246485464, 39.99962549285092, 33.40646986771218, 39.47704388384078, 41.430345100113676, 39.37225866215586, 41.13870635731426, 34.75421028644439, 40.847286486609576, 40.48284691828135, 36.987220910435624, 40.25392251002779, 40.80019934564942, 39.94992138744576, 34.655221972453184, 40.10118501994966, 41.470005386332346, 40.609737805318495, 39.708425148329184, 32.88338445580792, 34.87657498165821, 33.498443788412686, 38.131382011094914, 40.73845027689923, 41.564181607952335, 41.29489782265826, 36.361259052095924, 38.7078903759984, 42.415076113998744, 43.58923634252395, 42.95148466426546, 41.995350385944235, 40.35782823710601, 33.20900927346393, 39.087711438735646, 31.921446071499297, 37.18430456480079, 34.07681523840745, 40.74384721558265, 41.66490066565099, 41.697916548733346, 40.12529649376287, 33.725624677410984, 32.919030649294506, 38.61917213575806, 32.27729972093188, 38.73407985547312, 34.94677571594674, 31.602369060830586, 30.416695953202307, 31.514840835114054, 37.27183415842172, 39.91126422326614, 32.439608297642984]
    #grn_net 28.08
    grnnet = [14.02974039911512, 15.413514505610085, 16.835439939091113, 17.61288855639013, 19.893304248660456, 24.050261339334504, 28.26147878312173, 31.1795570526769, 25.863331589967903, 29.064632024176696, 29.99519348981737, 30.750810338853142, 30.265629828423272, 29.420363768698667, 29.12081816114975, 28.956138137205407, 28.688645456692083, 27.225970878694618, 26.19275620975595, 25.978069866400027, 25.833075466884488, 24.34515149411785, 22.240211933350356, 23.180372109541175, 23.8889396949263, 24.61613631812178, 24.95752928972434, 24.846527125564137, 24.63405965209541, 25.359577170501186, 24.322164801953626, 20.35729741299116, 20.031695647249737, 22.359900891694227, 22.672215208392025, 23.937296600700755, 25.67422477888432, 26.403409848115377, 26.47687456884734, 26.113587037618316, 26.30157807476087, 25.718612348158395, 25.08625027246618, 25.29522225856436, 25.238523046856844, 25.434414387085553, 25.05592154830059, 24.972496848513615, 25.504079619321196, 24.90575295636554, 24.720968597454835, 24.184688994102956, 23.042823190507495, 24.298342516438886, 26.143476961276914, 27.054175675219284, 23.225614633166668, 16.849381056090223, 15.009720465757127, 18.245321797000706, 13.29645415423655, 11.877661039362728, 20.42645911208019, 20.289295600193643, 24.526696571563843, 22.707616541620833, 20.782173509287176, 20.92043641064194, 21.648969240800895, 22.721522134835574, 27.655471094067163, 27.973491923655047, 23.09295904811444, 18.149433631918576, 20.7100870434448, 28.042845882741098, 26.846550589990365, 23.01523350879434, 22.635048771633485, 22.23231183218846, 21.472859772585394, 23.825651770227502, 25.446440575622198, 26.86432966720328, 30.500645332304824, 21.914455021225084, 22.082514296872855, 26.930522536855804, 28.360123527527055, 21.661431261706817, 20.034846615862904, 18.52602974959229, 16.776589125595507, 20.286895316282283, 20.16350404485019, 21.87638725088973, 21.2032258085579, 21.999681499045067, 25.440491602643522, 33.2673518151484, 31.085575142879158, 25.84558815375769, 25.233149557396995, 25.74709489240437, 26.796102424135956, 27.585536626266016, 28.321014093217585, 30.543354516713045, 34.81195512683, 33.347133051021544, 31.307061264038506, 29.72732078165445, 30.187123354463445, 31.28831333696411, 31.185927281442467, 31.25107309054738, 30.41691315348878, 29.107362748606125, 28.9925550472765, 28.330243090972147, 27.486596342014042, 26.789261156302715, 26.36720576154644, 27.390850967109884, 31.595777242165738, 32.44051898438082, 34.56623178609439, 37.29992654201948, 38.57043360346634, 38.7920640778251, 36.395618753395496, 34.619164505649735, 33.64585373898989, 32.165860231338094, 31.592414107809127, 30.867428555912234, 31.821620990806867, 32.92432356419292, 30.30588222420149, 29.968098719275606, 31.437877682094182, 33.12950446509845, 37.94407368859151, 37.747594266934236, 37.73731705873598, 36.7730149266678, 38.982709731448494, 39.9045284582991, 39.07509377462554, 40.44764989632646, 39.370430133005414, 40.65602800365704, 39.93760974930139, 39.132454343039115, 39.32485648000431, 34.99939096534247, 38.293904367855504, 38.693943029386034, 40.5829724361194, 40.27308382145569, 39.806946026698846, 39.725071097390455, 39.29261260115763, 39.74706375494086, 39.745454126716865, 39.633125026008564, 39.097408594508906, 35.80258274086722, 32.33935009511866, 30.558810812197805, 29.33892475354761, 29.668919671026956, 29.77097298618125, 29.852768123550266, 31.04872142268402, 31.533755902135074, 30.795728378275683, 30.853099196132064, 30.638520236020067, 30.28150942252616, 30.830889994910034, 29.845707748369502, 28.742029677500682, 30.116734837346385, 29.349451235131887, 24.601757922751325, 27.621222509981678, 27.341968734947528, 28.266852817628777, 27.95355772435885, 23.851585111824576]
    # macnet 32.70
    macnet = [23.92221335515941, 25.47875905779259, 27.235638852148675, 32.21506621628662, 30.498674353259393, 30.782589426883167, 25.352473609733323, 29.78122091786527, 24.224344298122475, 32.20747541742814, 32.91349429171832, 29.45917802068938, 33.68105621359725, 29.999348080686215, 32.719985851892915, 25.140665917779547, 32.68839059340722, 23.780333084011858, 23.384376567525248, 32.12084175164536, 25.27511672070844, 22.779078741757747, 30.437415437049232, 28.83111815651244, 24.48524004948533, 28.367248793943634, 27.766900219561997, 21.52702653434149, 27.208237268593344, 22.717331573454214, 25.65785103033894, 26.916609059205136, 27.910465214421095, 26.737979427692412, 27.41508963300319, 16.621449205097804, 29.47441646717845, 19.226686244995697, 23.01669980662072, 28.60238867265647, 30.552212147280304, 28.50424652589167, 26.108289947583323, 27.11700160814585, 16.21360069358902, 28.063510026984343, 28.189851349295928, 30.229627454516198, 26.29984908635152, 29.82591447981637, 29.823957926845353, 28.325894859701755, 14.931966622450247, 26.445709589573852, 27.206918956994876, 16.220860713948166, 28.506441317053874, 26.17201016991362, 25.37896650356902, 27.170168417265582, 22.553669944481936, 25.25386057961385, 27.744211228481017, 23.17826929695029, 29.92093111891816, 27.30276780939375, 29.15272862788202, 28.681818692189434, 27.791165368953155, 28.882494851475506, 31.089163116257716, 32.77013853169293, 34.06680311533356, 37.20653448411534, 37.238796009887935, 33.801196194815375, 32.128385871509025, 29.355883843640335, 31.091835972032335, 31.053653979486246, 27.009352645855547, 31.262725927996847, 32.32171030987632, 31.72101142566563, 26.3755498330463, 26.930274089153077, 44.53201913093224, 38.104874715874224, 20.77435084466217, 31.684279547698665, 33.73466725485416, 33.20919783478467, 32.487034873455315, 30.21948427644113, 29.22985192086194, 31.554495862218342, 31.277793284377495, 31.96397435211512, 33.56702644807105, 35.67842792023935, 43.27314527506324, 52.48892004070238, 59.041661818224355, 34.71278282319231, 45.59909799048526, 16.972707900938918, 44.158713358021174, 39.02559516655762, 23.182831728388592, 34.359275871472036, 33.29088233492381, 23.908723527627878, 34.67783504964458, 34.543267311451984, 36.13432311200306, 35.230265251965406, 36.13377681893499, 23.441720841571005, 33.16560985971068, 37.00446620307714, 37.40168432048759, 34.478343598932085, 36.513682985722895, 37.85671612645405, 25.43597438456488, 27.761036322091716, 29.796414430245868, 31.706930262806697, 31.845887675168004, 36.20785311403634, 38.26232190437699, 42.7734555805731, 38.97164436735187, 40.08861328917186, 24.809283385999194, 50.844304394364286, 44.110752337398566, 40.890462054707925, 41.0416507737093, 31.903641633320497, 49.55580669144537, 43.229978962997116, 39.528383164113016, 38.378375991249165, 36.66481913775898, 40.98037030382281, 39.322084137332666, 38.64452271738024, 37.76301709098719, 37.20548003448344, 36.45358441865576, 24.003004751397793, 36.53932816546564, 37.29007190424208, 37.50996074834013, 37.86824735005619, 23.269749897451298, 35.073810697193124, 35.380274379378925, 44.23696511085551, 37.985681379567055, 40.168838816022, 38.523354053179425, 38.53691696723095, 44.246616150262525, 41.75882806277844, 41.18157300584351, 43.05045890265185, 41.64941815493194, 45.54301357700104, 32.21317611150933, 43.58009573902565, 21.431134149714115, 46.280351974862654, 32.62934593421929, 45.33520948703998, 45.50421269935044, 44.489874786665915, 47.62521930453522, 30.446543640355888, 29.37343379676176, 44.98222568570437, 25.639860999959303, 50.26030067870606, 46.91729424784217, 30.94487820387171, 20.651692072934487, 28.83560039447282, 49.0108193285274, 52.63709129488237, 28.556248608408247]
    # t3sc 32.86
    t3sc = [29.966784056826707, 30.062245376596827, 33.07441848579162, 32.84964298066412, 35.10512865029683, 36.272711543975326, 29.407178073170464, 33.605155781315304, 32.39159518728195, 33.183000551615734, 33.77650762444711, 31.751463211313204, 34.421024849460245, 33.05829857157168, 32.904968429041766, 27.638838211228883, 32.57672692104371, 30.709968882362347, 30.01786373676144, 32.12868962986993, 31.090887061570697, 31.006417472076386, 30.413362335900334, 31.454971551322444, 29.290537200816267, 30.51746230875377, 29.895010011817355, 28.783991328970266, 30.06095715946457, 28.38856702784868, 28.02978686897211, 27.04221221825781, 27.373289389788724, 27.25445998953984, 28.73074462349586, 28.726637447915493, 30.954541645986794, 28.00722791459567, 26.87847434018096, 30.085640794971237, 30.63756369273253, 29.534116333447876, 27.989978548188333, 29.688920475021924, 26.798336368477777, 29.58820959794788, 30.54032307293253, 30.856001662389634, 30.500362019022212, 30.82943626270817, 30.638438933733738, 30.219262481801827, 23.39382510568948, 27.30147911252042, 28.523130542970346, 24.99881628446829, 28.59113550557076, 25.765496381403356, 24.70706740577439, 26.960182163704907, 23.355714752038118, 22.55915453298455, 24.48668041790052, 24.972825615335413, 28.374659339068305, 27.55088835361649, 26.442223458606406, 26.786961492365627, 26.492443743628762, 28.201731997285435, 31.677085091602848, 33.05816439162353, 29.688352278979412, 25.526620478440734, 28.049764356103193, 33.089734908496986, 31.985668227664124, 29.597030328052657, 29.356505599207967, 29.431611682779053, 28.378242588366305, 30.506415562622543, 31.472149473480826, 32.52628453779076, 32.06320111413031, 27.431565886235653, 27.10425120465279, 31.512818317138304, 32.57856577898113, 28.587325933934373, 27.79784958427626, 26.169992532350026, 25.15968869338515, 27.04565738118926, 27.37008053473462, 29.566613584753153, 28.9658710261746, 29.30161924895385, 31.505169463473102, 36.05458268677653, 36.8105748766538, 32.547598948135715, 32.99582275330262, 34.215753067700284, 35.47940931837332, 33.08781209194564, 37.788806283519975, 39.70148236281781, 34.744288572154275, 34.399801737521415, 32.68437337821194, 32.54805294251656, 34.12959008155293, 32.67583633644645, 36.508462770983634, 33.61869679424646, 36.07889432745755, 34.49438751411924, 35.26138077601723, 34.06660598696662, 33.241102036744294, 31.366794371344312, 32.3840676617142, 32.781787452891805, 32.59821626467318, 34.09905000850608, 36.652877882543535, 38.9345391305929, 34.920289345802516, 41.39144802580725, 42.99982188762829, 40.642076122186836, 35.59516334825649, 36.92500035749508, 33.65568011187023, 36.79344053652565, 38.51698036148012, 44.114894610950685, 42.70331377902971, 34.32772204043029, 44.06060642702123, 41.83438371545277, 37.625931408804206, 43.39272242518334, 29.906380328467645, 44.11840136898014, 40.44502089349124, 36.93337239983491, 41.48959390212737, 41.71653420422159, 40.032528085301166, 34.59658114941866, 41.83669115913153, 42.28302344522454, 42.41670789136285, 30.569644768808896, 33.970892239943275, 30.598678878305215, 35.74712526235369, 27.380621922191104, 38.148346858948806, 35.076052782154, 41.506592672915524, 33.99239461764422, 40.10999716575342, 43.30750256079445, 37.64906381326525, 37.43591184715963, 39.54755240471134, 33.402869925810506, 35.05662685464783, 36.58195840264629, 33.86987167492282, 28.322410933445195, 34.62453499533976, 41.26336782701741, 39.10470124567536, 41.959094618742306, 43.03408514163855, 33.84735858990499, 29.236805085282278, 39.2812600224185, 34.79827647009111, 34.22909130385836, 37.03271316092759, 38.132195737152166, 30.19658943391044, 32.66341954472742, 35.95888668028814, 41.767186760291494, 37.28623532982538]
    # lrtdtv 29.79
    llrgtv = [29.33807907	,29.07373595,	31.32806437,	28.43550448	,31.35649545	,31.48555947,	10.2319249	,32.59128129	,30.91517543	,32.88065657	,32.58556522	,32.082589	,30.76906201	,29.74748735	,31.75434102	,32.35443474	,32.55351513	,32.10689352	,12.28709504,	31.23182628	,32.88447462	,31.98876754,	32.03818042,	32.08776293	,31.34851719	,30.95827461	,30.47557445,	30.95865575,	29.96734751,28.908755,26.91692276]
    # llrgtv 36.32
    lrtdtv = [22.46379842970686, 25.407357045249533, 33.59222269452664, 33.27917870045632, 33.19762954952552, 32.99039854670219, 29.086306472070373, 33.75381699250631, 34.157179183751076, 33.616668897126, 33.4131627026565, 31.42842244226656, 33.60774558630183, 31.05040566860591, 30.797723957849065, 15.63071284793162, 29.728225235795747, 17.168951647465068, 15.094160383253897, 30.692474452747494, 30.0200185188, 30.092842611993515, 31.350884783426423, 30.499900869424103, 29.034420637162057, 29.675070133411886, 29.61433027946139, 30.030003297862624, 31.116079828751, 30.448173455860136, 30.341729809045294, 29.527352171954803, 28.961250818414, 28.233480142799756, 28.75192837387417, 28.92438169685019, 28.683195183973332, 28.07516610008816, 28.28619954137398, 28.84639720424901, 29.552571485337502, 25.180778028702523, 20.504921657755595, 23.74671196550171, 18.313522305945607, 27.28747645216825, 28.440770607255793, 28.720382836896302, 29.523821895931917, 29.237155196727322, 29.143308353518623, 29.32976962543153, 17.618920326446982, 27.666876350618907, 29.115100521801033, 30.644253739693077, 30.532403440482238, 25.907126556689786, 24.922983198014336, 27.54096994448168, 26.508241980377175, 25.681841592862614, 26.677492892399385, 24.723097029465407, 28.66705594968422, 28.532019815406695, 27.022290102930935, 26.97454023637882, 25.873066914919193, 27.410752095362007, 30.043317253552743, 31.18353504225262, 33.19230386792212, 38.718835644022384, 35.173990033485495, 32.87264702400396, 31.405907354390926, 30.29876943916374, 30.20522095632806, 30.24284887938673, 29.516979974047736, 31.078007738752646, 31.354865682943952, 31.54656350260214, 32.79678440420477, 36.696396332003395, 44.04502751921502, 41.39487668500564, 33.93941313125472, 30.499040071309302, 33.15310787335215, 31.70580366360261, 31.09069659232628, 30.04686216629913, 31.85076713688181, 34.810364349005056, 33.51276719276128, 34.74771288973892, 36.084548751921425, 38.1773038372793, 40.60886746056746, 48.35449502881432, 43.74431050983334, 46.11875158146308, 45.894699170531055, 45.07402336917612, 41.257782969634704, 38.29426628214571, 36.09194602612475, 33.41529434888096, 30.173203821210635, 29.229128776871967, 29.263367685082677, 30.626261388091716, 34.4865210076677, 33.63184065861029, 33.910804241848275, 35.44823123551526, 36.59160096699346, 32.948570509177394, 32.9367429395563, 31.359877000870682, 32.12364470350582, 34.463712778110974, 33.15899863860915, 37.340009658902886, 40.41489517957683, 42.359650982280414, 43.706443810210544, 44.19059721036329, 47.216039457596715, 47.57679915598988, 44.22046739436064, 43.59933427670771, 45.82217118488284, 49.75456883115452, 50.65240969563156, 44.308572712338474, 45.440171793259275, 52.34724952149713, 52.187365477246345, 46.495899031667435, 43.47985215984066, 44.45307935991708, 47.90427193439257, 48.17416582133334, 45.25344829684191, 43.094601286000355, 42.440768389256945, 42.07977611788615, 41.994079705551385, 42.76341995135385, 43.29577378861876, 43.71559654148661, 44.927756675326634, 45.9948875998386, 45.747031954296546, 46.240972655252946, 46.357510976987555, 46.68056597913221, 45.9481402798871, 45.723861936764635, 46.184890442947626, 46.243720678384754, 47.052653086160696, 45.824551041245684, 46.55657654430003, 46.987733122441064, 47.657244987843974, 48.66294957969139, 48.26122486803851, 48.054559325319076, 49.00426223275656, 48.089147245502716, 48.49665603749419, 48.22705547702411, 47.732135517656744, 48.18884598581604, 50.04083883791603, 43.5765676335705, 43.15327050901064, 43.3032248531663, 36.732818824795835, 55.5111872584234, 52.81125513642722, 54.223205658622646, 40.546213166306586, 40.36097022656233, 57.87475416891014, 59.82407884826405, 42.322188987921166]
    # sst 33.01
    sst = [18.235870040674016, 21.281292552955918, 25.060962866064052, 25.855102173449218, 30.366819062468295, 35.70432901476468, 35.645044563775556, 30.9411171010097, 25.72206638711016, 31.93301836810805, 34.7962608319413, 34.82870466080552, 31.072289819065478, 30.26271983232965, 31.33181158655937, 31.740281881164716, 32.9476352955435, 33.79629238700229, 33.80734897953611, 33.522724015938095, 33.19984439672587, 32.231761794093586, 28.06830586258898, 31.740217350513042, 31.541913493346534, 31.81167391117899, 31.525695122357288, 31.269153260446203, 31.09097459433746, 25.740645316085377, 28.45695422811606, 17.6528097240849, 20.10479943456957, 23.10757308185394, 23.986326911215162, 28.320481203559062, 32.03813967139666, 29.893276550503497, 29.51583980558736, 30.70302212755294, 31.786133358439134, 31.71905562555827, 29.897903185404914, 28.725229830236906, 29.953818142045144, 30.017976182939616, 28.563101387514184, 29.16053358069991, 29.659354877451875, 29.682733291397348, 30.469172272229375, 31.568665354407138, 28.056096527856006, 29.6828635026252, 33.00187671572675, 28.747809095218315, 30.677478715175216, 25.613750626296667, 25.833439270940033, 25.737797617138813, 23.4227287228188, 24.290983453121797, 27.295300918968085, 24.616012039991087, 29.469994490916243, 28.97199243484892, 24.156448912460775, 22.153412132383203, 22.231861562498718, 22.463159484770507, 30.06362179808267, 33.41067341630156, 27.714129167311018, 20.666099964880942, 22.393152484740753, 30.47614206521866, 33.135819447557324, 28.302991058955996, 27.465211153509593, 25.18959264765662, 22.044965284030024, 24.526381960878624, 26.37313295181302, 28.161506790586152, 33.31611252054466, 21.433186185218318, 21.223080841728073, 26.504290231837278, 30.01992021462175, 22.222116135865114, 20.574304473018206, 19.13906377203215, 17.719972073562715, 30.20364895832353, 30.255808830240447, 31.370991632899127, 29.58312686767476, 25.83487927210792, 25.718758151031864, 28.6290851469607, 39.95984281762454, 32.116374550996525, 30.300364194457945, 32.63681127456081, 37.80661416882762, 36.238926969918055, 36.414096198330675, 40.324568461189116, 36.09917908166474, 32.67601866478425, 30.028263174129965, 30.177143322981216, 33.76810904852858, 36.7567341745751, 36.1936350009159, 34.07678989843823, 34.252720718972235, 34.78324341029661, 36.6112077459313, 37.50737074456874, 33.22283978490923, 32.109397122783115, 28.73247733361, 28.192174941191045, 31.11878547079624, 32.19107911102429, 35.71127636996983, 38.38359918870364, 40.670869944605606, 43.60316408960699, 45.79923749593216, 43.1047556581175, 39.777457599586214, 39.378414237654034, 40.02561280782152, 42.11243012334716, 46.5611572443526, 47.18969125312724, 47.67292487182235, 44.31324439372278, 44.4387557662308, 48.10464511742039, 43.9899439852278, 45.16722145432691, 47.91671895872746, 47.78894328127251, 46.54023901180007, 45.15101326448157, 44.4506458704315, 44.23149649384235, 43.2452022618014, 41.6169871341595, 41.792201444785306, 41.336118106904436, 40.775259287116725, 44.95940909122399, 44.10997381765163, 44.98401453426474, 45.36933615198463, 45.702184576540496, 45.528734967125274, 45.3615486890795, 45.52644603571998, 45.640106878028746, 46.16985219822417, 46.54112094580974, 46.87659867834134, 46.84428034660729, 46.46265010574052, 47.56269996910093, 47.33297965489045, 47.07000671335873, 48.5289568740878, 48.818505455013856, 49.94437942335077, 48.83776825206908, 50.50516104455283, 50.955637082832666, 52.052055335312815, 52.72787894626112, 52.347872635343855, 51.80567207558779, 51.508808329925, 54.315572430506556, 52.730114521017725, 52.212957904512784, 46.67815776698113, 47.48875291045357, 47.595616300365435, 46.29840924708094, 43.149227530040626]
    # sert 35.64
    sert = [27.991117242321316, 24.15219457625438, 29.322933680123285, 32.1146361574819, 34.96571356117046, 35.30689672880493, 34.20120677155712, 32.21969862222029, 27.12165675351435, 32.35973776853168, 35.37162258022735, 34.45880961210661, 33.26291225972915, 30.31539117202871, 32.03139209151451, 32.930022366192944, 33.1469525294388, 32.729557861509285, 33.19200856312356, 32.673848747169664, 32.37377284748747, 31.44577604465183, 27.551114391962493, 29.905388039595447, 29.94054535129301, 30.68137948440323, 29.775439447904795, 26.432168575510644, 28.525795505752143, 23.185813453600215, 20.82537129636666, 23.87460897259325, 24.09985420656075, 28.40648175606043, 28.888360867176807, 31.63209693569961, 30.72198225528333, 27.80933674666125, 30.139469592736123, 32.110910718871864, 32.85322262963087, 31.13140214561546, 29.067176900565784, 29.26101830441894, 30.382666296543015, 31.438294201490802, 31.301880873681178, 31.556937146065028, 32.221671063092984, 31.684036014962093, 32.28061381796807, 32.78333811577146, 28.83786006043198, 29.671872659410575, 32.76457716376429, 28.16829709200652, 28.992818156889356, 24.267894643644098, 23.02031479259735, 27.21230549750779, 21.145238004826133, 19.75232885494902, 27.717459308321168, 24.463324309759386, 29.904839627287387, 28.61541140147731, 25.91682454572988, 22.055105328572118, 22.696548640887034, 21.84841960667456, 26.982297619742024, 29.446412588087835, 33.485888578655945, 22.687072897662116, 23.635903630501826, 35.29125484868329, 30.753876176479803, 29.737536106286893, 31.990085638723208, 31.172093881355885, 27.40624109350239, 29.89514111682211, 28.57157948175306, 29.412300801826756, 35.19416464908102, 23.71944296533448, 22.737803574601223, 26.614555379289136, 31.110267732616776, 23.79730507736244, 23.042050911398704, 21.995714266786223, 20.534784561111245, 30.849911267097184, 30.36424887786009, 32.37165764143421, 31.547002124222043, 29.34431104000632, 29.21735493005402, 36.16475941859649, 39.19458492455674, 30.24860089547579, 30.005623026097986, 33.64064454206938, 36.64379883200172, 35.936618492730155, 39.815219835364736, 41.339030967852494, 36.69530326966883, 33.84491543550376, 32.84409985197497, 32.78752778463501, 35.73042153516995, 37.63902496080835, 37.7444235741569, 36.88917509674078, 37.470246696436945, 38.161969078980356, 38.38111301038826, 36.38942128071571, 32.09521519365588, 31.530406635786882, 30.011011170272006, 28.663600143945658, 32.36659011888957, 33.71282143430128, 37.3283899247081, 39.92533480693682, 41.66067763836013, 43.75474658668737, 45.42732007029413, 43.96242640325363, 40.75858899517704, 40.34756334546333, 42.4071908739008, 43.56822472624269, 48.43930743237919, 47.307749034709666, 47.48804647854175, 44.14063997243433, 44.02593923877939, 48.37319951834939, 44.07368054821984, 45.27277776993265, 47.956309833369986, 47.83773439289655, 46.50865981209789, 44.964926675447614, 44.243145946619535, 43.96390504726692, 42.816986331104665, 40.588385575447106, 40.26154314012749, 39.771712819496315, 40.703677190794565, 44.42218787165022, 43.71476241263114, 44.59056458349184, 45.23168114337625, 45.668456192660145, 44.16794724005686, 44.68609394237441, 45.06720066297046, 45.700712848424914, 45.97743247749881, 46.29526827745554, 46.22827282231701, 45.12866196891451, 43.02580507468086, 42.2957076761631, 42.48764156027741, 43.59020245027324, 45.01559402319827, 47.126172780673336, 48.287416663188544, 48.60001449076569, 49.089383613334306, 50.34288782184053, 51.06854692270495, 50.445978539829646, 51.55099629797522, 51.71634481966899, 52.58141310824811, 52.26006672316701, 53.00976493459685, 48.461625885083215, 50.199954904766756, 51.36399820102344, 52.420625496278404, 53.054950703664346, 53.67577801259457]
    # s2s 39.89
    s2s = [36.44577163962727, 36.01516986597041, 38.32066862799917, 38.11648521489568, 38.22797546271249, 38.32971185283763, 38.00402418928546, 38.33943382768999, 35.15177454112357, 37.99613241410099, 37.24532474615683, 37.008194197015236, 36.52442096035231, 35.55963103822046, 35.190917168759086, 35.05732772728435, 35.05423887742782, 34.74818546727279, 35.15136199427016, 35.39341181871964, 34.40895416807125, 34.062900554417006, 35.56610087988382, 34.93988727913005, 34.19599172709366, 34.759620820799306, 34.7449099665807, 34.89556090385857, 35.09747812578233, 35.33675154205775, 35.236902065571854, 34.95004648270746, 34.75703484056192, 34.31680490943337, 33.85752061652508, 33.63435256341336, 33.771938658675225, 34.06580098742015, 34.10340359234959, 34.14258321730187, 34.568603293281996, 34.017188987360555, 33.39363558456541, 34.19231686258661, 34.470676007380135, 34.57528429495141, 34.4004052344552, 34.20000135851601, 34.21711068250249, 33.53024191299443, 32.86937095247916, 32.31533276924019, 32.21489031767156, 33.15766489746407, 33.28350003794093, 32.711695482146, 33.90625518228485, 30.4382632424714, 29.353855146061644, 28.249892973630057, 29.97355602698803, 29.53170686425743, 30.01829045020335, 30.944938371928146, 31.440851468072463, 31.452519891464043, 31.074293934266688, 31.01419978764546, 31.100932643905935, 31.69597467318554, 33.562321342561965, 32.25379909593305, 37.07622424788789, 32.31512329336637, 37.028358697001266, 37.080573530399086, 35.98243122828876, 35.394724158530046, 35.33873188741382, 35.01845975139843, 34.81862907802162, 35.41033539492731, 35.67323614763582, 33.79838956594583, 33.884369642665845, 30.334188864828793, 31.166782028040746, 35.89476289161026, 33.429136272854436, 35.40389949219074, 37.11780863068893, 36.92431740525609, 36.73609822976441, 36.55087413841269, 36.88667543874939, 36.25877192269574, 36.77474555383722, 37.04632061448954, 37.68865516335212, 37.61633871505448, 45.24224865520403, 37.394388605297834, 38.21171978586978, 44.15732239563517, 46.46123391599221, 44.892441107920156, 41.23313766408461, 42.788115811540465, 39.491847424315985, 38.7522838048884, 38.812137543790094, 38.566858191425496, 38.88677321621916, 39.51184936349434, 39.60362129953994, 39.835713568166724, 40.091127197830446, 39.88530167120541, 40.102173858239965, 39.903379979792895, 39.41966725202907, 39.14725690270273, 39.634404512200035, 40.57617504498652, 41.223651256053344, 42.13652276056053, 42.82366300464693, 44.20403206416086, 46.570922222436565, 47.797483108990036, 49.99951827588096, 47.613036856075574, 44.33304968880961, 43.936902520232906, 44.19713832066247, 45.966303119777116, 50.0712593836824, 49.98548539770318, 47.65576553425737, 45.72940100570377, 44.56527563894339, 48.30788959098757, 47.6593879144595, 48.19570471853535, 49.52221203646408, 48.409846275642124, 47.582044976463905, 47.6570833042953, 47.30874293411355, 47.124153712087924, 46.41790184670592, 45.941528467832704, 46.629809276642106, 46.8215030081437, 47.45416241191725, 47.82569766721295, 47.03654023712556, 47.76862858394426, 47.66754685447584, 47.93187983363873, 47.460672359417714, 47.9666040992069, 47.86415720282236, 47.77063104415532, 47.685007506331225, 48.448961578227944, 47.904882051051445, 47.97382298545145, 47.54945561939888, 47.38471939852197, 47.087760899022356, 48.07153089094548, 48.044578157412374, 48.989715041277876, 49.30833160609666, 50.03324448292326, 50.03189009276802, 50.587163694626, 47.97233247026729, 49.296608235249295, 49.6927559792739, 50.711666930149946, 51.04151530934928, 48.82450294288344, 48.87027858644677, 49.9412855306284, 49.420851401943, 51.139725886534215, 52.593796470253274, 49.51945902907099, 43.7923614519717]
    #grunet 31.37
    grunet = [29.203908966447052, 30.58621076680531, 34.23999519563954, 33.74271308030211, 33.44352679216972, 33.28420620437433, 32.901214794831674, 33.102397377046756, 28.34935767814878, 31.794741465135385, 32.0361542055841, 31.693067376262395, 31.215495419545512, 30.261777259547884, 30.059514152999213, 29.172648775743735, 29.277610362492723, 27.144208657858357, 26.588196620596193, 28.056876622125472, 28.021727574539057, 28.131633276209456, 28.1426836436283, 28.476517604159476, 28.118286236072624, 28.177631862876716, 28.140688350403416, 27.55619477996514, 27.445313732339987, 27.522192592183693, 27.921454781778607, 27.754259867702253, 27.68742464698351, 27.398818971618756, 27.090031100048183, 26.573229872257926, 26.85065510688911, 26.27102729356337, 26.995101371419853, 27.109829086620326, 26.978833830786584, 26.295598880364757, 25.481760155800703, 25.92123322205628, 26.530685769460366, 26.66216742778873, 26.69490104175867, 26.787760523518077, 27.059235577144808, 26.757563908672605, 26.48321806558808, 26.459536842370778, 25.865749891922793, 27.011155742983846, 26.558313067277446, 27.282335383083115, 27.68065507713797, 23.901673061313787, 23.81877099523413, 25.678537204899733, 25.154221585537524, 24.333825136897417, 24.874782229908202, 25.43651069961022, 24.8662179437613, 25.673971772682386, 25.883711439348236, 25.830487967324267, 25.393008031420617, 24.795523382956976, 27.592604173206198, 25.589583424241358, 29.29394954879054, 29.9585253158147, 30.54308402061709, 29.974222593969564, 27.44306931988082, 26.5856898950117, 27.641545768889635, 27.768213098345413, 27.576308073712333, 27.958133047251703, 28.27230076198716, 27.574612761505076, 30.151566467904154, 26.466780105173342, 28.314712656323483, 31.670377199203234, 30.840085199579164, 28.676682455373808, 29.70312072396675, 30.109748073627962, 29.21193980802833, 28.904042205890175, 29.990268264892173, 31.177707614336377, 30.685521630412712, 29.38747279582611, 30.21655127660881, 31.55456534107129, 33.42797109615897, 33.31541228589718, 33.4586465227407, 33.13354483100462, 33.69950823089377, 31.43816377486897, 33.87015005961448, 34.8862714688447, 33.86528468557523, 32.44362981700129, 31.043970211975157, 31.850319790811433, 32.00684355482561, 32.96629827225717, 33.555948103239515, 33.25417161909874, 33.597199405622916, 33.16545006606914, 33.65152629459741, 33.83650835795369, 33.69592657317126, 32.714087289441586, 32.26931655635313, 32.544002206458956, 32.148990086617694, 33.659939563308455, 34.08055862430568, 34.226812359020215, 33.94504872247931, 35.45603717961243, 35.91594716096344, 34.33180796045988, 30.414207127802793, 29.462418997996984, 28.452008043845236, 31.968539691403585, 34.214966671693624, 34.91920122538639, 35.21115946569152, 33.14216115114761, 36.11528823383381, 37.34484914871106, 37.40115002269086, 36.87636495225511, 36.976817774429236, 37.642462929036824, 37.11467786891529, 36.71499288264584, 36.88134007218684, 37.01915285842935, 36.491715823396305, 34.7739726559451, 35.631473082364494, 36.35981544608046, 36.64914165899118, 36.083892185751985, 33.081406780449775, 33.66311585239484, 33.411851576506834, 35.41978253632908, 37.188146955718175, 37.56199324023033, 37.65739060640659, 37.65883167278095, 36.656168314794414, 36.11055156550868, 36.385103200606906, 35.585307776232085, 37.83603300982002, 38.66126168617345, 38.57831786913968, 37.918527109401104, 36.656921344177206, 37.27046141304108, 38.172757364221994, 38.45842642803015, 38.22472248823616, 38.34819629467217, 38.65482744367572, 38.22290246813929, 36.91529436383501, 36.17685487371029, 36.44617351687763, 33.55113089409045, 31.8895252215857, 30.484582990893927, 30.50009508955707, 31.465460485227158, 32.75006592693009, 35.30675599566663, 40.13459478606889]
    # NGMeet 28.81
    ngmeet = [28.35133994241767, 30.227968286452306, 31.317164884585296, 29.608486782181444, 32.91653714059314, 32.368434001921344, 28.158181239361394, 31.131476543348, 16.31372416547161, 31.727317026736124, 30.87847580904119, 28.39213677039412, 29.431926001107584, 27.539894779193347, 28.28961858988013, 15.32187292791502, 27.75427967329413, 14.741646532424495, 14.36620268565096, 27.8062643660246, 17.751707277275614, 14.739621508479617, 26.046440630840845, 26.899309775502065, 17.644864177999764, 26.316212040672006, 26.201756031254703, 14.458420119179271, 26.69555043962184, 17.103626511215385, 25.74712269125858, 25.0499337127509, 25.6523981269814, 24.888247371853097, 24.153120694960982, 14.298571280593766, 25.464616857706964, 16.838103146571637, 20.169294674266713, 23.638701435709567, 24.26680686060803, 23.965728598296995, 22.687104085098323, 22.709345686375432, 13.693936440988386, 23.258357210038074, 22.870295509118904, 24.0503029559393, 22.481745282329424, 23.349715123256747, 23.46457975354433, 22.559802583182712, 12.826309428884144, 23.039310565204126, 23.704911036801143, 13.601086930949894, 26.109780402154172, 23.657594717050987, 23.423339465975587, 25.502144673685955, 21.708043228766158, 23.34344910690472, 23.578090634954386, 14.796945183334586, 25.50628856989782, 20.38346228505546, 24.044135209758135, 23.775991530092767, 23.60941566080365, 24.051422836862265, 26.04921082429485, 27.613683517232296, 28.77623121003574, 32.91188793242909, 32.83579874169004, 25.93037851406805, 26.419381187008355, 24.53723420875136, 25.423775812248202, 24.222348979876056, 13.426460006594505, 25.99990615044228, 27.173558169303114, 28.00704602760249, 14.504912838032894, 17.640458925040242, 39.74230979942631, 38.121307172549514, 10.825018096780736, 28.838430086426246, 30.292525027480618, 29.374865412011495, 29.478968744745057, 28.997131225404807, 28.230555374345325, 30.47140385066995, 30.109900481934137, 30.22318484289255, 30.985041016054073, 34.054099800241836, 40.80813454127477, 55.25083015165174, 55.12420311232732, 26.819638964605403, 44.078489458415966, 12.137598218665717, 44.52160542098479, 39.00812821480454, 17.35250710307013, 33.61483530428914, 32.2878836628366, 17.66036842256691, 33.446424840635785, 33.04030383443205, 34.3910176999601, 33.8334354169546, 33.57071060400272, 17.602691350592124, 26.816479642464422, 34.49929100003131, 34.76653598985977, 33.671233545866656, 34.23319077653895, 35.396015377222255, 36.258676254940994, 39.405897139292236, 41.17760724293032, 42.96099637371832, 12.443577252135658, 41.97038302740885, 49.03849475384302, 48.71919241051267, 16.641431640114924, 16.348830452972912, 9.085940428184562, 26.303672271205837, 26.086629361969436, 48.82300487581351, 48.889242317993656, 9.104794183624088, 56.67408050230404, 48.3608660956492, 26.477651385005014, 47.57377887724611, 12.135484353055219, 49.58651255973553, 47.020156559040096, 16.639910205913154, 47.3271044771415, 46.41582581314659, 45.6138042336015, 9.159283384428988, 46.20866343944803, 45.71441884965501, 47.77133949140925, 45.12711969363751, 9.337335817179262, 16.718976344130407, 12.131264131852236, 26.17125066979062, 47.12195806016815, 46.913167005998005, 47.521179403623215, 16.736395665797513, 26.5150513164527, 49.07936698248154, 49.35209330963616, 46.66334243480865, 43.75027107017665, 47.918115868591904, 9.174145432031507, 45.12836818132576, 9.183591222520764, 26.13340436974888, 12.061198041750306, 51.76057781244079, 47.085844006288895, 52.65252101315863, 54.322247955002155, 12.180716256400682, 11.984653515342911, 49.66224551175208, 9.190219129361395, 57.85160317148282, 26.26058799135165, 12.064257795106032, 9.125384752629838, 12.096258019651367, 26.61707443194896, 52.302218756747564, 12.036844263793105]
    # LLRT 21.97
    llrt = [13.428575983346136, 13.781662763771518, 13.93036094439206, 13.99846142247975, 13.925037356149462, 13.95415322899895, 13.950057004754985, 14.54698632939991, 16.038919324486635, 14.373524862131271, 13.894722474256403, 13.417144878031241, 12.992212798853053, 12.308229145492053, 12.22958799983643, 12.799501530830675, 12.468691958084221, 13.409193768058017, 13.542406310439938, 12.87509486337357, 13.043680658445977, 13.105101567281093, 13.028983091163957, 12.688018838468327, 12.674334122142877, 12.509712221418672, 12.543915938336847, 13.10871812030796, 13.160588842795134, 13.158760583114324, 12.540484860937053, 12.312191477242195, 12.219312689629142, 12.049474425726658, 12.054940527052691, 12.492567889699382, 12.239538167836692, 12.654179182249123, 12.50332235099457, 12.066090280680939, 12.335030660675969, 12.031138359125901, 11.785959282037375, 12.082726796392155, 12.602171844504785, 12.326497019537923, 12.261446005248121, 12.344295827422773, 12.588469421146108, 12.580474575774677, 12.616213682418927, 12.93612330458423, 14.072138186944612, 12.986297148910396, 12.369087292835657, 13.679269727898841, 12.455853381164186, 10.78921949269768, 10.614606505976445, 12.744082802901032, 10.689670565805418, 10.349364020893326, 10.62396887157037, 11.677051221924868, 12.439426438861185, 11.925148673234807, 11.342151860295342, 11.334116166243223, 11.370221509388845, 11.919734342092132, 13.89079050103156, 14.804947796774204, 17.815146496216695, 22.690829769649817, 19.950061793615912, 16.403881951826477, 14.175783918582292, 13.157758666770832, 13.181382532296812, 13.278969783835619, 13.80953838078195, 13.977647085233198, 14.70796515700426, 15.40165144556395, 18.578404872529788, 25.220997400082226, 29.255269989634535, 26.27570769330777, 21.397611285555683, 18.65967629148801, 18.30160039544389, 17.930129388032274, 17.274544700883762, 17.044533203373216, 17.468160055098544, 18.46047694861103, 18.03126499422157, 18.501560516511415, 20.36136946529772, 23.587400498836764, 28.81922481598216, 42.00282965601978, 44.19343071992802, 31.2452130302976, 38.11943272123604, 25.686605234858074, 33.41317436184343, 29.7629439038538, 25.638690029082213, 24.536676492745965, 23.338110976735223, 23.01877443432753, 22.69310522082805, 23.218718897652607, 23.691108520920864, 23.442738609624936, 23.946942548804408, 23.880366859074428, 24.20371200994321, 24.13427570108633, 23.96941135755344, 23.791925586174656, 24.50684130913126, 25.30636378511368, 26.118460187934463, 26.814909016686546, 28.269687299697942, 32.052352749421715, 26.07252642315226, 30.850546770842, 38.18852368762499, 38.44127857194615, 26.464441329400195, 26.049316031056353, 23.514676164946565, 29.214216618748043, 32.089736223815166, 38.253833966409104, 35.08076590105092, 23.778781209088002, 39.06765182967614, 35.91059950552048, 31.9895978471357, 39.16492221526351, 25.213763474702382, 39.84601919717423, 31.488530539404096, 27.357584041628407, 36.140487650522104, 33.743005953907904, 33.84321141475379, 24.178501564719504, 37.23609869659335, 33.88658148997083, 34.42313670594618, 38.45072656920573, 24.225516730720567, 27.50532706851473, 25.49830895719301, 30.533359534462786, 31.493529420873504, 36.558536527099925, 38.698869712544585, 27.768693418150438, 32.16120826076268, 38.93273544700605, 39.86190386868477, 32.14987051533178, 39.340161444203375, 35.01141880724864, 24.021676546725466, 37.81219421309736, 23.951226500303395, 30.31034835878181, 24.896340163351237, 31.70485319794157, 31.522003739640674, 35.68706131615474, 42.5867055965329, 24.864605866920503, 24.698523992668136, 31.39172845785176, 23.61330853160912, 42.35987973778278, 29.39795191063178, 24.973358838528362, 23.475898457892505, 24.58994908651047, 31.63689568954837, 39.21751888914696, 25.120027790333683]
    # LLRG 34.32
    llrg = [22.1489668778340,22.7515060394709,25.0298267673234	,25.0906666038290	,25.3302296505337	,25.5498063427902,	22.4361546724318,	26.3245669249048,	27.2551807217432	,26.8237271772121,	26.6315013823677,	24.9765278064579	,26.3230488128008,	25.7493472416371	,26.1124867615988	,22.6882502169324	,26.7130334888088	,25.2096859926433,	21.9330763160824,	27.6799718786038	,26.7827217442308,	26.9813744260433,	25.8843421557038,	28.3383548190298	,27.6322657459449	,28.6959614012453,	28.9567184719390,	28.8131525057019,	30.2814284101711	,28.9250419149780	,30.2491192200475,	27.8251503012530,	29.8925639880143,	25.8853135925849,	29.7703984445681,	28.6546019397469,	29.4144438861919,	28.4279395717098	,28.3007927425039,	28.1041668896061,	28.6102858136417,	25.2034463286009,	22.8396942645271,	24.7784565189248,	23.8754764578644,	25.2947193758281	,26.6374080769786	,26.7009123531005,	26.6758202146740	,26.5852861681591	,26.2802829599857	,26.4231290299769	,23.3627025611028,	23.3624985574888,	28.5948461490768,	27.9069304413571,	31.0506621291836,	26.7527171297685	,26.6273482971083	,27.6746768759864	,25.9600483849582,	26.7882880814126,	27.0370541761338,	27.1023700376710,	28.5806679565938,	27.8353672901833,	27.6668905474849,	27.3804020517429,	25.2074505996185,	26.7295205157347,	28.8918725730105	,30.6616859289424,	33.3794011821776,	37.1996591744946,	35.4818804138311,	32.4887534326608,	30.5229834963613	,29.4044817312610	,29.3426348370793,	29.2842146604778,	26.5838187070692,	29.8667643363107	,30.2300505754664	,31.0586728829362,	31.6215149232289,	37.4172324885382	,35.1847754933713	,41.1297907616884,	29.1612746549855,	30.0088159929223	,33.3908342677053	,29.9267349379767,	32.4207834810593,	32.2686706900512,	30.9571483145491,	33.3978712250409	,33.0632149006259,	33.3901515077761,	34.3925673020701,	37.0548434064835,	41.3632924937876,	55.8317531891707,	55.1933033319992,	49.4842995516001,	48.5437953590255,	44.1580026773950,	38.0582786582624,	39.8431338551123,	35.8499741957687,	35.0215066911018,	28.2345274825690,	33.4943608259883	,30.2043667634081,	27.5535405740422,	35.9658785752789,	29.2887207643911,	31.4177285207053,	35.9920537797763	,36.6468741288836	,30.8370240050775,	35.2488142310898,	28.2452216774747,	31.9058664506889,	36.6147737051360,	31.9975972756230	,39.5426193829216,	40.5029983137113,	43.1640603936919,	40.1172924217168,	44.0441884027157,	47.7529802379036,	47.4643354771719,	37.0162085920724,	36.6834775606306,	24.7660352110346,	43.8058243635743,	53.3307713332632,	45.2609313759218	,43.2877779105355,	23.8614574373407,	50.5049053066437,	42.4930239632197,	48.4800347829901,	46.8934188236330,	30.9792642570849,	46.1362770592077,	43.4677153151521,	43.4070838216405,	45.0646008919524,	45.1172080721566	,39.2818805111737,	18.7086400828997,	47.6452660750588,	44.3497851232380	,46.0361624380966	,48.8927331117729,	26.3231705879001,	48.1158412318466,	45.8990198766343,	46.2570558782905,	45.2419100717148,	45.5699914824454,	48.3711868957048,	49.0566381646038,	50.2239112614173,	43.9042857696148	,47.7245171154049,	44.5667946959108,	49.9865625996633,	47.8872572173107,	31.5966340779644,	45.9501916795689,	30.7397690363709,	49.0643967445306,	30.9038690635902,	44.6530406106201	,42.5797721251981,	45.8386167233433,	49.0753596204052,	31.3595240997677,	30.2059405608132,	44.4462995289336,	17.8274629784536,	53.1998411441233,	46.3898265625591,	56.0616756012242	,22.0754437951856,	31.3022083587570,	50.1335684416998,	48.2209351137861,	53.3913741961982]
    # 创建一个折线图
    plt.plot(Bands, s2s ,color= 'red', label='S2S')
    plt.plot(Bands, noisy, color= 'gray',label='Noisy')

    plt.plot(Bands, sert, color= '#8c564b',label='SERT')
    plt.plot(Bands, sst ,color= '#9467bd', label='SST')
    plt.plot(Bands, grunet ,color= '#8c564b', label='GRUNet')
    plt.plot(Bands, t3sc, color= '#e377c2',label='T3SC')
    plt.plot(Bands, macnet ,color= '#2ca02c', label='MACNet')
    plt.plot(Bands, grnnet, color= '#ff7f0e',label='GRNet')
    plt.plot(Bands, qrnn3d ,color= '#1f77b4', label='QRNN3D')
    
    # plt.plot(Bands, lrtdtv ,color= '#8c564b', label='LRTDTV')
    # plt.plot(Bands, ngmeet ,color= '#9467bd', label='NGMeet')
    # plt.plot(Bands, llrt ,color= '#8c564b', label='LLRT')
    # plt.plot(Bands, llrg ,color= '#e377c2', label='LLRGTV')

    plt.ylim(0, 60)

    # 添加标题和标签
    # plt.xlabel(r'Band')
    # plt.ylabel(r'PSNR')
    
    plt.legend(loc='upper right',bbox_to_anchor=(1.11, 1))

    # 保存图片为PNG文件
    plt.savefig('/home/jiahua/HSI-CVPR/hsi_pipeline/wdc_bands_dp.png')

def get_point_bans():
    h,w = 200,100
    methods_dp = ['noisy','sert_base','sst','grunet_nobn','t3sc','macnet','grn_net','qrnn3d','s2s']
    methods_tra = ['noisy','wdc_LLRT','LRTDTV','wdc_LLRGTV','wdc_NGMeet','s2s']
    labels_dp = ['Noisy','SERT','SST','GRUNet','T3SC','MACNet','GRNet','QRNN3D','S2S(Ours)']
    labels_tra = ['Noisy','LLRT','LRTDTV','LLRGTV','NGMeet','S2S(Ours)']
    colors = ['gray','#9467bd','#8c564b','#ACD24E','#e377c2','#2ca02c','#ff7f0e','#1f77b4','red']


    test_path = '/data1/jiahua/result/wdc/'

    
    plt.figure(figsize=(12, 4),dpi=400)
    ax = plt.gca()
    Bands = np.arange(191)  # Band number
    gt = loadmat(os.path.join(test_path,'gt.mat'))  
    gt = gt['data'][w,h,:]

    for i,method in enumerate(methods_tra):

        img = loadmat(os.path.join(test_path,method+'.mat')) 
        img = img['data'][...]
        if img[0,0,0]>1:
            img = img/255
        data = img[w,h,:] - gt
        if method != 's2s':
            plt.plot(Bands, data ,color= colors[i], label=labels_tra[i], alpha=0.6)
        else:
            plt.plot(Bands, data ,color= 'red', label=labels_tra[i])
    
    plt.ylim(-0.5, 0.5)
    plt.xlim(0,191)

    # handles,labels = ax.get_legend_handles_labels()
    # handles = [handles[-1],handles[:-1]]
    # labels = [labels[-1],labels[:-1]]
    # ax.legend(handles,labels)

    plt.legend(loc='upper right',bbox_to_anchor=(1.14, 1))

    # 保存图片为PNG文件
    plt.savefig('/home/jiahua/HSI-CVPR/hsi_pipeline/wdc_points_tra.png')

def get_band_psnr():

    test_path = '/data1/jiahua/result/wdc/'

    gt = loadmat('/data1/jiahua/result/wdc/gt') 
    gt = gt['data'][...]
    # gt = gt.transpose((2,1,0))
    # print(gt.shape)
    rect_list = os.listdir(test_path)

    for rect in rect_list:
        print(rect)
        img = loadmat(os.path.join(test_path,rect)) 
        img = img['data'][...]
        print(img.shape)
        print(img[1,1,1])

        if 'LLRT' in rect :
            img = img / 2000
        elif  'NGMeet' in rect:
            img = img / 255
        # img = img.transpose((2,1,0))
        psnr = []
        c,h,w=gt.shape
                
        for k in range(c):
            psnr.append(10*np.log10((h*w)/sum(sum((gt[k]-img[k])**2))))
        # gt=torch.tensor(gt)
        # img=torch.tensor(img)
        # psnr = np.mean(cal_bwpsnr(gt, img))

        print(sum(psnr)/len(psnr))
        # print(psnr)

def rename_folds(path):
    rect_list = os.listdir(path)

    for rect in rect_list:
        # print(os.path.join(path,rect.split("_")[0]+'.png'))
        # os.rename(os.path.join(path,rect),os.path.join(path,rect.split("_")[0]+'.png'))
        os.rename(os.path.join(path,rect),os.path.join(path,rect.split(".png")[0]+'.png'))


def splitImage(path):

    save_path = '/home/jiahua/HSID/result/split_img'
    
    img = cv2.imread(path)
    print(img.shape)
    H,W,_ = img.shape
    split_scale = 4
    
    for i in range(split_scale):
        for j in range(split_scale):
            tmp = img[i*(H//split_scale):(i+1)*(H//split_scale),j*(W//split_scale):(j+1)*(W//split_scale),:]
            print(tmp.shape)
            cv2.imwrite(os.path.join(save_path,str(i)+'_'+str(j)+".png"),tmp)
        
def draw_spectral_cuve(noise_linear,gt_linear):
    import numpy as np
    import matplotlib.pyplot as plt

    # # 生成干净的曲线数据
    # x = np.linspace(0, 10, 1000)
    # y_clean = np.sin(x)

    # # 添加噪声
    # noise = np.random.normal(0, 0.1, y_clean.shape)
    # y_noisy = y_clean + noise
    
    y_clean = gt_linear
    y_noisy = noise_linear

    # 计算傅里叶变换
    fft_clean = np.fft.fft(y_clean)
    fft_noisy = np.fft.fft(y_noisy)

    # 计算频谱的幅度和相位
    amplitude_clean = np.abs(fft_clean)
    phase_clean = np.angle(fft_clean)
    amplitude_noisy = np.abs(fft_noisy)
    phase_noisy = np.angle(fft_noisy)

    # 绘制幅度和相位曲线
    plt.figure(figsize=(12, 6))

    plt.subplot(2, 2, 1)
    plt.plot(amplitude_clean)
    plt.title('Amplitude (Clean)')
    plt.xlabel('Frequency')
    plt.ylabel('Amplitude')

    plt.subplot(2, 2, 2)
    plt.plot(phase_clean)
    plt.title('Phase (Clean)')
    plt.xlabel('Frequency')
    plt.ylabel('Phase')

    plt.subplot(2, 2, 3)
    plt.plot(amplitude_noisy)
    plt.title('Amplitude (Noisy)')
    plt.xlabel('Frequency')
    plt.ylabel('Amplitude')

    plt.subplot(2, 2, 4)
    plt.plot(phase_noisy)
    plt.title('Phase (Noisy)')
    plt.xlabel('Frequency')
    plt.ylabel('Phase')

    plt.tight_layout()
    plt.savefig('test.png')
            
def getSpectralcuve(h,w):
    
    img = loadmat('/data3/jiahua/ly/test_data/wdc_complex/512_mixture/wdc.mat')
    noise = img['input'][...]
    gt = img['gt']
    
    noise_linear = noise[h,w,:]
    gt_linear = gt[h,w,:]
    
    
    draw_spectral_cuve(noise_linear,gt_linear)
    
    
    
    
    



if __name__ == '__main__':
    
    getSpectralcuve(0,0)
    
    # get_rgb()
    # drawRect('cave',1)
    # rename_folds('/home/jiahua/HSI-CVPR/hsi_pipeline/figure/cave_big')
    # get_real_top_k()
    # tmp()
    # residual_noise('/home/jiahua/HSI-CVPR/hsi_pipeline/figure/icvl_img_big/')
    # get_res()
    # get_2048_from_1024_batch()
    # result_resize()
    # get_band_psnr()
    # draw_bands_fig()
    # get_point_bans()

    # img = loadmat('/data1/jiahua/ly/test_data/cave_test_complex/cvpr/fake_and_real_food_ms.mat')
    # input = img['input'][...]
    # img = img.transpose((2,1,0))
    # img = img.transpose((1,0,2))
    # gt = img['gt']
    
    # spectral.save_rgb("/home/jiahua/HSI-CVPR/hsi_pipeline/result/cave/Noisy.png",img,bands=(9,19,29))
    # savemat('/data1/jiahua/result/indian/s2s.mat',{'data':img})
    # splitImage("/home/jiahua/HSID/result/demo/urban_fidnet.png")